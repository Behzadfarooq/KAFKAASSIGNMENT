<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="Bayesian multivariate linear regression,Kronecker product,Linear least squares,Linear regression,Normal distribution,Normally distributed,Pseudoinverse,Vectorization,Inverse-Wishsart distribution,Linear Bayesian regression" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>Bayesian multivariate linear regression - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-0">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Bayesian multivariate linear regression</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"></div>
	    	    <div class="usermessage">You have <a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">new messages</a> (<a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">last change</a>).</div>	    <!-- start content -->
	    <p>Consider a collection of m <a href="../../../l/i/n/Linear_regression.html" title="Linear regression">linear regression</a> problems for n observations, related through a set of common predictor variables <span class="texhtml">{<i>x</i><sub><i>c</i></sub>}</span>, and a jointly normal errors <span class="texhtml">{ε<sub><i>c</i></sub>}</span>&#160;:</p>
<dl>
<dd><img class='tex' src="../../../math/a/3/0/a30d8ebb673eac82d73a6bbbb6f3419c.png" alt="y_{1} = \beta_{i} x_{1} + \epsilon_{i},\," /></dd>
</dl>
<dl>
<dd><img class='tex' src="../../../math/7/e/2/7e2bd690c52c0527df9c870e75715848.png" alt="y_{c} = \beta_{c} x_{c} + \epsilon_{c},\," /></dd>
</dl>
<dl>
<dd><img class='tex' src="../../../math/6/9/0/6901c72be4281e8656136f2489e4dbfc.png" alt="y_{m} = \beta_{c} x_{m} + \epsilon_{m},\," /></dd>
</dl>
<p>where the subscript c denotes a column vector of k observations for each measurement (<span class="texhtml"><i>n</i> = <i>k</i> + <i>m</i></span>).</p>
<p>The noise terms are jointly normal over each collection of k observations. That is, each row vector <span class="texhtml">{<i>r</i>}</span> represents an m length vector of correlated observations on each of the dependent variables:</p>
<dl>
<dd><img class='tex' src="../../../math/0/9/d/09d59f19c49ffe14d38b52f81ba1c252.png" alt="y_{r} = B^{T}x_{r} + \epsilon_{r},\," /></dd>
</dl>
<p>where the noise <span class="texhtml">ε<sub><i>r</i></sub></span> is i.i.d. and <a href="../../../n/o/r/Normally_distributed.html" title="Normally distributed">normally distributed</a> for all rows <span class="texhtml">{<i>r</i>}</span>.</p>
<dl>
<dd><img class='tex' src="../../../math/3/0/f/30ff00860ab3404ab2b4d5656667dd32.png" alt="\epsilon_{r} \sim N(0, \Sigma_{\epsilon}^2).\," /></dd>
</dl>
<p>where B is an <img class='tex' src="../../../math/8/9/7/8978dc8a2708f1402abbc90e6506c3f7.png" alt="k \times m" /> matrix</p>
<dl>
<dd><img class='tex' src="../../../math/7/0/f/70fb5c5fe26159cd099b35a325479fea.png" alt="B = [\beta_{1},\cdots,\beta_{c},\cdots, \beta_{m}]\," /></dd>
</dl>
<p>We can write the entire regression problem in matrix form as:</p>
<dl>
<dd><img class='tex' src="../../../math/0/6/4/06436c2fcd9255a33b00ec1974cc6532.png" alt="Y =B^{T}X + E,\," /></dd>
</dl>
<p>where Y and E are <img class='tex' src="../../../math/2/5/2/252d3754c0db62a55b9e25c870a524a5.png" alt="n \times m" /> matrices.</p>
<p>The classical, frequentists <a href="../../../l/i/n/Linear_least_squares.html" title="Linear least squares">linear least squares</a> solution is to simply estimate the matirx of regression coeeficients <img class='tex' src="../../../math/a/f/d/afdee8ffdb158bd9c8da5da143860d63.png" alt="\hat{B}" /> using the Moore-Penrose <a href="../../../p/s/e/Pseudoinverse.html" title="Pseudoinverse">pseudoinverse</a>:</p>
<dl>
<dd><img class='tex' src="../../../math/5/6/c/56c4a2642617bd935dd54b6813c3acf2.png" alt="\hat{B} = (X^{T}X)^{-1}X^{T}Y" />.</dd>
</dl>
<p>To obtain the Bayesian solution, we need to specify the confitional likelihood and then find the appropriate conjugate prior. As with the univerate case of linear Bayesian regression, we will find that we can specify a natural conditional conjugate prior (which is scale dependent).</p>
<p>Let us write our conditional likelihood as</p>
<dl>
<dd><img class='tex' src="../../../math/6/b/e/6be189f97f2980106707201ffc17e098.png" alt="\rho(E|\Sigma_{\epsilon}) \propto (\Sigma_{\epsilon}^{2})^{-n/2} exp(-\frac{1}{2} tr(E^{T} \Sigma_{\epsilon}^{-1}E) ) ,\," /></dd>
</dl>
<p>writing the error E in terms Y,X, and B yields</p>
<dl>
<dd><img class='tex' src="../../../math/b/6/7/b6703f631e46bc4056ed025261790eb4.png" alt="\rho(Y|X,B\Sigma_{\epsilon}) \propto (\Sigma_{\epsilon}^{2})^{-n/2} exp(-\frac{1}{2} tr((Y-BX)^{T} \Sigma_{\epsilon}^{-1}(Y-BX)) ) ,\," /></dd>
</dl>
<p>We seek a natural conjugate prior—a joint density <span class="texhtml">ρ(<i>B</i>,σ<sub>ε</sub>)</span> which is of the same functional form as the likelihood. Since the likelihood is quadratic in <span class="texhtml"><i>B</i></span>, we re-write the likelihood so it is normal in <img class='tex' src="../../../math/c/d/7/cd744d819134fc69f2fe8325aeb7049c.png" alt="(B-\hat{B})" /> (the deviation from classical sample estimate)</p>
<p>Using the same technique as with linear Bayesian regression, we decompose the exponential term using a matrix-form of the sum-of-squares technique. Here, however, we will also need to use the Matrix Differential Calculus (<a href="../../../k/r/o/Kronecker_product.html" title="Kronecker product">Kronecker product</a> and <a href="../../../v/e/c/Vectorization.html" title="Vectorization">vectorization</a> transformations).</p>
<p>First, let us apply sum-of-squares to obtain new expression for the likelihood:</p>
<dl>
<dd><img class='tex' src="../../../math/6/c/c/6cc74bcc61fd0702f3115063172021cc.png" alt="\rho(Y|X,B,\Sigma_{\epsilon}) \propto \Sigma_{\epsilon}^{-(n-k)/2} exp(-tr(-\frac{1}{2}S\Sigma_{\epsilon}^{-1}))   (\Sigma_{\epsilon}^{2})^{-k/2} exp(-\frac{1}{2} tr((B-\hat{B})^{T} \Sigma_{\epsilon}^{-1}(B-\hat{B})) ) ,\," /></dd>
</dl>
<dl>
<dd><img class='tex' src="../../../math/b/6/b/b6b236479392b02c71b75e4342d714c1.png" alt="S = Y - \hat{B}X" /></dd>
</dl>
<p>We would like to develop a conditional form for the priors:</p>
<dl>
<dd><img class='tex' src="../../../math/1/6/d/16d89e1901877b1c43aa0a5b8ccbb932.png" alt="\rho(B,\Sigma_{\epsilon}) = \rho(\Sigma_{\epsilon})\rho(B|\Sigma_{\epsilon}),\," /></dd>
</dl>
<p>where <span class="texhtml">ρ(Σ<sub>ε</sub>)</span> is an inverse-Wishsart distribution and <span class="texhtml">ρ(<i>B</i> | Σ<sub>ε</sub>)</span> is some form of <a href="../../../n/o/r/Normal_distribution.html" title="Normal distribution">normal distribution</a> in the matrix <span class="texhtml"><i>B</i></span>. This is accomplished using the <a href="../../../v/e/c/Vectorization.html" title="Vectorization">vectorization</a> transformation, which converts the likelihood from a function of the matrices <img class='tex' src="../../../math/5/f/9/5f9d9065a637c6423180556921fe8314.png" alt="B, \hat{B}" /> to a function of the vectors <img class='tex' src="../../../math/b/9/8/b98afa6645b333e586c13d40025d90df.png" alt="\Beta = vec(B), \hat{\Beta} = vec(\hat{B})" />.</p>
<p>Write</p>
<dl>
<dd><img class='tex' src="../../../math/8/8/4/8845b20ffa7c7c2f0752d0800a1c7376.png" alt="tr((B - \hat{B})^{T}X^{T} \Sigma_{\epsilon}^{-1} X(B - \hat{B})) = vec(B - \hat{B})vec(X^{T} \Sigma_{\epsilon}^{-1} X(B - \hat{B}))" /></dd>
</dl>
<p>Let</p>
<dl>
<dd><img class='tex' src="../../../math/1/f/c/1fc54c18526a5492e7e87179457d12da.png" alt="vec(X^{T} \Sigma_{\epsilon}^{-1} X(B - \hat{B})) =  (\Sigma_{\epsilon}^{-1} \otimes X^{T}X )vec(B - \hat{B})" /></dd>
</dl>
<p>Then</p>
<dl>
<dd><img class='tex' src="../../../math/d/8/2/d8274b94efb03819d2e7db94def80c0b.png" alt="tr((B - \hat{B})^{T}X^{T} (\Sigma_{\epsilon}^{-1} \otimes X^{T}X )vec(B - \hat{B})" /></dd>
</dl>
<dl>
<dd>
<dl>
<dd>
<dl>
<dd><img class='tex' src="../../../math/a/a/d/aadb6c69a589c47eaa03ee6e7e9c0cf7.png" alt="= (\beta-\hat{\beta})(\Sigma_{\epsilon}^{-1} \otimes X^{T}X )(\beta-\hat{\beta})" /></dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>which will lead to a likelihood which is normal in <img class='tex' src="../../../math/c/6/7/c678c200908abaa37f0b24e173139632.png" alt="(\beta - \bar{\beta})" />.</p>
<p>With the likelihood in a more tractable form, we can now find a natural (conditional) conjugate prior.</p>
<p>(to complete)</p>
<p><b>Example:</b></p>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="../../../b/a/y/Bayesian_multivariate_linear_regression.html" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ul>
<li>Bradley P. Carlin and Thomas A. Louis, <i>Bayes and Empirical Bayes Methods for Data Analysis</i>, Chapman &amp; Hall/CRC, Second edition 2000,</li>
</ul>
<ul>
<li>Peter E. Rossi, Greg M. Allenby, and Robert McCulloch, <i>Bayesian Statistics and Marketing</i>, John Wiley &amp; Sons, Ltd, 2006</li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="../../../b/a/y/Bayesian_multivariate_linear_regression.html" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>

<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../b/a/y/Bayesian_multivariate_linear_regression.html">http://en.wikipedia.org../../../b/a/y/Bayesian_multivariate_linear_regression.html</a>"</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../b/a/y/Category%7EBayesian_statistics_6ca7.html" title="Category:Bayesian statistics">Bayesian statistics</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="../../../b/a/y/Bayesian_multivariate_linear_regression.html">Article</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../b/a/y/Talk%7EBayesian_multivariate_linear_regression_4dda.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/Bayesian_multivariate_linear_regression">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 07:50, 11 March 2007 by Wikipedia user <a href="../../../j/i/t/User%7EJitse_Niesen_c0c4.html" title="User:Jitse Niesen">Jitse Niesen</a>. Based on work by Wikipedia user(s) <a href="../../../r/j/w/User%7ERjwilmsi_027f.html" title="User:Rjwilmsi">Rjwilmsi</a> and Charlesmartin14 and Anonymous user(s) of Wikipedia.</li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
