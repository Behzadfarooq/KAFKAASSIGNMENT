<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="Bayesian linear regression,Bayes' theorem,Bayesian probability,Estimation of covariance matrices,Inverse-gamma distribution,LU decomposition,Linear least squares,Linear regression,Normal distribution,Normally distributed,Positive-definite matrix" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>Bayesian linear regression - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-0">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Bayesian linear regression</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"></div>
	    	    <div class="usermessage">You have <a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">new messages</a> (<a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">last change</a>).</div>	    <!-- start content -->
	    <p>In <a href="../../../s/t/a/Statistics.html" title="Statistics">statistics</a>, <b>Bayesian linear regression</b> is a <a href="../../../b/a/y/Bayesian_probability.html" title="Bayesian probability">Bayesian</a> alternative to the more well-known ordinary least-squares <a href="../../../l/i/n/Linear_regression.html" title="Linear regression">linear regression</a>.</p>
<p>Consider standard <a href="../../../l/i/n/Linear_regression.html" title="Linear regression">linear regression</a> problem, where we specify the conditional density of <i>y</i> given <i>x</i> predictor variables:</p>
<dl>
<dd><img class='tex' src="../../../math/b/e/e/beea4ab7e7f7a833c63356c9abac43e1.png" alt="y_{i} = \beta x_{i} + \epsilon_{i},\," /></dd>
</dl>
<p>where the noise <span class="texhtml">ε</span> is i.i.d. and <a href="../../../n/o/r/Normally_distributed.html" title="Normally distributed">normally distributed</a></p>
<dl>
<dd><img class='tex' src="../../../math/6/1/1/61111868416e14e2a087b2b3ac2343d4.png" alt="\epsilon_{i} \sim N(0, \sigma^2).\," /></dd>
</dl>
<p>A common, <a href="../../../l/i/n/Linear_least_squares.html" title="Linear least squares">linear least squares</a> solution, is to estimate the slope <img class='tex' src="../../../math/5/9/e/59e7a0027ecbfe68dfba72292a2db279.png" alt="\hat{\beta}" /> using the Moore-Penrose <a href="../../../p/s/e/Pseudoinverse.html" title="Pseudoinverse">pseudoinverse</a>:</p>
<dl>
<dd><img class='tex' src="../../../math/7/9/4/79458cd11bd9064482768df1798a6a28.png" alt="\hat{\beta} = (X^{T}X)^{-1}X^{T}y" />.</dd>
</dl>
<p>where <span class="texhtml"><i>X</i></span> is the vector of <span class="texhtml"><i>x</i><sub><i>i</i></sub></span> (of length <span class="texhtml"><i>n</i></span>).</p>
<p>This is a frequentist's view, and assumes we have enough measurements of <span class="texhtml"><i>x</i><sub><i>i</i></sub></span> to say something meaningful about y. In the empirical Bayes approach, we will assume we have only a small sample of <span class="texhtml"><i>x</i><sub><i>i</i></sub></span> for our individual measurement, and we seek to correct our estimate by "borrowing" information from a larger set of similar observations.</p>
<p>Let us write our conditional likelihood as</p>
<dl>
<dd><img class='tex' src="../../../math/d/8/8/d885afbe0a72254b1ebbb87416e6af8e.png" alt="\rho(y|X,\beta,\sigma^{2}) \propto (\sigma^{2})^{-n/2} \exp(-\frac{1}{2{\sigma}^{2}}(y-\beta X)^{T}(y-\beta X)),\," /></dd>
</dl>
<p>We seek a natural conjugate prior--a joint density <span class="texhtml">ρ(β,σ<sup>2</sup>)</span> which is of the same functional form as the likelihood. Since the likelihood is quadratic in <span class="texhtml">β</span>, we re-write the likelihood so it is normal in <img class='tex' src="../../../math/a/5/7/a579528380f0e316c735e7b20671529f.png" alt="(\beta-\hat{\beta})" />. Write</p>
<dl>
<dd><img class='tex' src="../../../math/7/f/b/7fb66bc4fcf3de6df6c821d3ce3b5ac5.png" alt="(y-\beta X)^{T}(y-\beta X) = (y-\hat{\beta} X)^{T}(y-\hat{\beta} X) + (\beta - \hat{\beta})^{T}(X^{T}X)(\beta - \hat{\beta})" /></dd>
</dl>
<p>Now re-write the likelihood as</p>
<dl>
<dd><img class='tex' src="../../../math/d/4/3/d43f3eae9d97376855428dfa99e9f8a0.png" alt="\rho(y|X,\beta,\sigma^{2}) \propto (\sigma^2)^{-v/2} \exp(-\frac{vs^{2}}{2{\sigma}^{2}})(\sigma^2)^{-(n-v)/2} \exp(-\frac{1}{2{\sigma}^{2}}(\beta - \hat{\beta})^{T}(X^{T}X)(\beta - \hat{\beta})),\," /></dd>
</dl>
<p>where</p>
<dl>
<dd><img class='tex' src="../../../math/b/0/3/b0357d630ee957ea467dfbf7649a1c91.png" alt="vs^{2} =(y-\hat{\beta} X)^{T}(y-\hat{\beta} X) \  , v = n-k" /></dd>
</dl>
<p>This suggests a form for the priors:</p>
<dl>
<dd><img class='tex' src="../../../math/3/8/2/382fa22e40b3e0015381fb7ba217ffa2.png" alt="\rho(\beta,\sigma^{2}) = \rho(\sigma^{2})\rho(\beta|\sigma^{2}),\," /></dd>
</dl>
<p>where <span class="texhtml">ρ(σ<sup>2</sup>)</span> is an <a href="../../../i/n/v/Inverse-gamma_distribution.html" title="Inverse-gamma distribution">inverse-gamma distribution</a></p>
<dl>
<dd><img class='tex' src="../../../math/2/4/b/24b6d1884e4c9620bb791f16aff0f6ad.png" alt="\rho(\sigma^{2}) \propto (\sigma^2)^{-v_{0}/2+1} \exp(-\frac{v_{0}s_{0}^{2}}{2{\sigma}^{2}}),\," /></dd>
</dl>
<p>and <span class="texhtml">ρ(β | σ<sup>2</sup>)</span> is a <a href="../../../n/o/r/Normal_distribution.html" title="Normal distribution">normal distribution</a></p>
<dl>
<dd><img class='tex' src="../../../math/0/b/9/0b93a0bb7d20eaf49993945a7f0c2dc1.png" alt="\rho(\beta|\sigma^{2}) \propto (\sigma^2)^{-k} \exp(-\frac{1}{2{\sigma}^{2}}(\beta - \bar{\beta})^{T}(A)(\beta - \bar{\beta})),\," /></dd>
</dl>
<p>With the prior now specified, we can express the posterior distribution as</p>
<dl>
<dd><img class='tex' src="../../../math/6/f/1/6f166ba9032f3d105abf704c355fdd30.png" alt="\rho(\beta,\sigma^{2}|y,X) \propto \rho(y|X,\beta,\sigma^{2})\rho(\beta|\sigma^{2})\rho(\sigma^{2})" /></dd>
</dl>
<dl>
<dd>
<dl>
<dd><img class='tex' src="../../../math/4/4/5/445a2370805f5a883867cc497fa3fe14.png" alt="\propto   (\sigma^{2})^{-n/2} \exp(-\frac{1}{2{\sigma}^{2}}(y-\beta X)^{T}(y-\beta X))" /></dd>
</dl>
</dd>
</dl>
<dl>
<dd>
<dl>
<dd>
<dl>
<dd><img class='tex' src="../../../math/7/a/b/7aba0dc19e7e0981a009eeae456f4243.png" alt="\times   (\sigma^{2})^{-k} \exp(-\frac{1}{2{\sigma}^{2}}(\beta - \bar{\beta})^{T}(A)(\beta - \bar{\beta}))." /></dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd>
<dl>
<dd>
<dl>
<dd><img class='tex' src="../../../math/d/b/0/db021e6fea86e5f09a45c560e3a7cf13.png" alt="\times  (\sigma^2)^{-v_{0}/2+1} \exp(-\frac{v_{0}s_{0}^{2}}{2{\sigma}^{2}})" /></dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>With some re-arrangement, we can re-write the posterior so that the posterior mean <img class='tex' src="../../../math/c/4/2/c4210b25065b52c808a8ca11b459193a.png" alt="\tilde{\beta}" /> is weighted average of the least squares estimator and the prior mean:</p>
<dl>
<dd><img class='tex' src="../../../math/7/1/9/719ce6d62a5bbf1ddc9e096953618f49.png" alt="\tilde{\beta} = (X^{T}X+A)^{-1}(X^{T}X\hat{\beta}+A\bar{\beta})" /></dd>
</dl>
<p>where <span class="texhtml"><i>U</i></span> comes from the <a href="../../../l/u/_/LU_decomposition_4db2.html" title="LU decomposition">LU decomposition</a> of <span class="texhtml"><i>A</i></span> (which is a <a href="../../../p/o/s/Positive-definite_matrix.html" title="Positive-definite matrix">positive-definite matrix</a> by design)</p>
<dl>
<dd><img class='tex' src="../../../math/c/4/e/c4e501ea43a1e04584eb989675477104.png" alt="A = U^{T}U. \," /></dd>
</dl>
<p>This is the key result of the Empirical Bayes approach; it allows us to estimate the slope <span class="texhtml">β</span> for our original linear regression problem by combining estimates using the least squares estimate <img class='tex' src="../../../math/5/9/e/59e7a0027ecbfe68dfba72292a2db279.png" alt="\hat{\beta}" /> for a single set of measurements with the empirical prior estimate <img class='tex' src="../../../math/9/b/f/9bfe8da00e7380022dfcee8b129f6bb3.png" alt="\bar{\beta}" /> from a large collection of similar measurements. (Notice that the weighted average also depends on the empirical estimate of the prior covariance matrix <span class="texhtml"><i>A</i></span>.)</p>
<p><br />
To justify this, collect the quadratic terms in the exponential and and now express this as a quadratic form in <img class='tex' src="../../../math/f/a/4/fa4cf46c59046a4c6fe7fd7cfdcffc6c.png" alt="\beta-\tilde{\beta}" />:</p>
<dl>
<dd><img class='tex' src="../../../math/9/3/5/93501e538f302da6cc99be237aa867ea.png" alt="(y-\beta X)^{T}(y-\beta X)) + (\beta - \bar{\beta})^{T}(A)(\beta - \bar{\beta}) = (v-W\beta)^{T}(v-W\beta)" /></dd>
</dl>
<dl>
<dd>
<dl>
<dd><img class='tex' src="../../../math/8/7/f/87f8f3565556ddf42d4564c9e313a891.png" alt="= ns^{2} + (\beta - \bar{\beta})^{T}W^{T}W(\beta - \bar{\beta})" /></dd>
</dl>
</dd>
</dl>
<p>where</p>
<dl>
<dd>
<dl>
<dd><img class='tex' src="../../../math/6/4/6/6462baed33c00c305afbc27ee613cf92.png" alt="ns^{2} = (v - W \tilde{\beta})^{T}(v - W \tilde{\beta}), v = [y, U\bar{B}], W = [X, U]" /></dd>
</dl>
</dd>
</dl>
<p>The posterior can now be expressed as a <a href="../../../n/o/r/Normal_distribution.html" title="Normal distribution">Normal distribution</a> <img class='tex' src="../../../math/2/5/f/25ffab93375b1253ac7602ddcd95c592.png" alt="N(\tilde{\beta},\sigma^{2}(X^{T}X+A)^{-1}" /> times an <a href="../../../i/n/v/Inverse-gamma_distribution.html" title="Inverse-gamma distribution">inverse-gamma distribution</a>:</p>
<dl>
<dd><img class='tex' src="../../../math/d/9/f/d9f0ce280ba72b5890cc84a65db17843.png" alt="\rho(\beta,\sigma^{2}|y,X) \propto  (\sigma^{2})^{-k/2} \exp(-\frac{1}{2{\sigma}^{2}}(\beta - \bar{\beta})^{T}(X^{T}X+A)(\beta - \bar{\beta}))\times  (\sigma^2)^{-(n+v_{0})/2+1} \exp(-\frac{(v_{0}s_{0}^{2}+ns^{2})}{2{\sigma}^{2}})" /></dd>
</dl>
<p><br />
A similar analysis can be performed for general case of multi-variate regression for a Bayesian <a href="../../../e/s/t/Estimation_of_covariance_matrices.html" title="Estimation of covariance matrices">Estimation of covariance matrices</a>.</p>
<p><br />
<b>Example:</b></p>
<p>Suppose the weights of a large population of 35-year-old men are <a href="../../../n/o/r/Normal_distribution.html" title="Normal distribution">normally distributed</a> with expected value μ and standard deviation σ. A crude measuring instrument measures a man's weight with a measurement error that is normally distributed with expected value 0 and standard deviation τ. The man's true weight is not observable; his weight measured with error is observed. The conditional probability distribution of a randomly chosen man's true weight, given his weight-measured-with-error, can be found by using <a href="../../../b/a/y/Bayes%27_theorem.html" title="Bayes' theorem">Bayes' theorem</a>, and then the conditional expected value can be used as an estimate of his true weight, <b>provided</b> that the values of μ, σ, and τ are <i>known</i>. But they are not. One may use the data to estimate the standard deviation of the measurement errors by measuring each man multiple times. One may similarly estimate the population average weight and the population standard deviation of weights by weighing multiple men. These estimates of parameters based on the data are the occasion for the use of the word <i>empirical</i>. Finally, one may then estimate the aforementioned conditional expected true weight by using Bayes' theorem.</p>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="../../../b/a/y/Bayesian_linear_regression.html" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ul>
<li>Bradley P. Carlin and Thomas A. Louis, <i>Bayes and Empirical Bayes Methods for Data Analysis</i>, Chapman &amp; Hall/CRC, Second edition 2000,</li>
</ul>
<ul>
<li>Peter E. Rossi, Greg M. Allenby, and Robert McCulloch, <i>Bayesian Statistics and Marketing</i>, John Wiley &amp; Sons, Ltd, 2006</li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="../../../b/a/y/Bayesian_linear_regression.html" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>

<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../b/a/y/Bayesian_linear_regression.html">http://en.wikipedia.org../../../b/a/y/Bayesian_linear_regression.html</a>"</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../b/a/y/Category%7EBayesian_statistics_6ca7.html" title="Category:Bayesian statistics">Bayesian statistics</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="../../../b/a/y/Bayesian_linear_regression.html">Article</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../b/a/y/Talk%7EBayesian_linear_regression_dc22.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/Bayesian_linear_regression">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 14:29, 17 March 2007 by Anonymous user(s) of Wikipedia. Based on work by Wikipedia user(s) <a href="../../../g/e/n/User%7EGene_Nygaard_634f.html" title="User:Gene Nygaard">Gene Nygaard</a>, <a href="../../../j/i/t/User%7EJitse_Niesen_c0c4.html" title="User:Jitse Niesen">Jitse Niesen</a>, <a href="../../../m/i/c/User%7EMichael_Hardy_e932.html" title="User:Michael Hardy">Michael Hardy</a> and Charlesmartin14.</li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
