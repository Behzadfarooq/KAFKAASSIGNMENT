<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="Bitap algorithm,Agrep,Big O notation,Bitmask,Bitwise operation,C (programming language),Communications of the ACM,Fuzzy string searching,Gaston Gonnet,Gene Myers,Inner loop" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>Bitap algorithm - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-0">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Bitap algorithm</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"></div>
	    	    <div class="usermessage">You have <a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">new messages</a> (<a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">last change</a>).</div>	    <!-- start content -->
	    <p>The <b>bitap algorithm</b> (also known as the <b>shift-or</b>, <b>shift-and</b> or <b>Baeza-Yates-Gonnet</b> algorithm) is a <a href="../../../f/u/z/Fuzzy_string_searching.html" title="Fuzzy string searching">fuzzy string searching</a> algorithm developed by <a href="../../../u/d/i/Udi_Manber_e104.html" title="Udi Manber">Udi Manber</a> and Sun Wu in 1991<span class="reference plainlinksneverexpand" id="ref_Manber91"><sup><a href="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html#endnote_Manber91" class="external autonumber" title="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html#endnote_Manber91" rel="nofollow">[1]</a></sup></span><span class="reference plainlinksneverexpand" id="ref_Manber92"><sup><a href="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html#endnote_Manber92" class="external autonumber" title="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html#endnote_Manber92" rel="nofollow">[2]</a></sup></span> based on work done by <a href="../../../r/i/c/Ricardo_Baeza-Yates_2ecc.html" title="Ricardo Baeza-Yates">Ricardo Baeza-Yates</a> and <a href="../../../g/a/s/Gaston_Gonnet_f936.html" title="Gaston Gonnet">Gaston Gonnet</a>.<span class="reference plainlinksneverexpand" id="ref_BYG89"><sup><a href="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html#endnote_BYG89" class="external autonumber" title="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html#endnote_BYG89" rel="nofollow">[3]</a></sup></span> The algorithm tells whether a given text contains a substring which is "approximately equal" to a given pattern, where approximate equality is defined in terms of <a href="../../../l/e/v/Levenshtein_distance.html" title="Levenshtein distance">Levenshtein distance</a> — if the substring and pattern are within a given distance <i>k</i> of each other, then the algorithm considers them equal. The algorithm begins by precomputing a set of <a href="../../../b/i/t/Bitmask.html" title="Bitmask">bitmasks</a> containing one bit for each element of the pattern. Then it is able to do most of the work with <a href="../../../b/i/t/Bitwise_operation.html" title="Bitwise operation">bitwise operations</a>, which are extremely fast.</p>
<p>The bitap algorithm is perhaps best known as one of the underlying algorithms of the <a href="../../../u/n/i/Unix.html" title="Unix">Unix</a> <a href="../../../p/r/o/Programming_tool.html" title="Programming tool">utility</a> <a href="../../../a/g/r/Agrep.html" title="Agrep">agrep</a>, written by Manber, Wu, and Burra Gopal. Manber and Wu's original paper gives extensions of the algorithm to deal with fuzzy matching of general <a href="../../../r/e/g/Regular_expression.html" title="Regular expression">regular expressions</a>.</p>
<p>Due to the data structures required by the algorithm, it performs best on patterns less than a constant length (typically the <a href="../../../w/o/r/Word_length.html" title="Word length">word length</a> of the machine in question), and also prefers inputs over a small alphabet. Once it has been implemented for a given alphabet and word length <i>m</i>, however, its <a href="../../../r/u/n/Running_time.html" title="Running time">running time</a> is completely predictable — it runs in <a href="../../../b/i/g/Big_O_notation_de3e.html" title="Big O notation">O</a>(<i>mn</i>) operations, no matter the structure of the text or the pattern.</p>
<p>This algorithm was improved by Baeza-Yates and Navarro in 1996 and later by <a href="../../../g/e/n/Gene_Myers_96d0.html" title="Gene Myers">Gene Myers</a> for long patterns in 1998.</p>
<p><a name="Exact_searching" id="Exact_searching"></a></p>
<h2><span class="editsection">[<a href="../../../b/i/t/Bitap_algorithm.html" title="Edit section: Exact searching">edit</a>]</span> <span class="mw-headline">Exact searching</span></h2>
<p>The bitap algorithm for exact <a href="../../../s/t/r/String_searching_algorithm.html" title="String searching algorithm">string searching</a>, in full generality, looks like this when implemented in <a href="../../../c/_/%28/C_%28programming_language%29.html" title="C (programming language)">C</a>:</p>
<pre>
<code>#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

typedef char BIT;

const char *bitap_search(const char *text, const char *pattern)
{
    const char *result = NULL;
    int m = strlen(pattern);
    BIT *R;
    int i, k;

    if (pattern[0] == '\0') return text;

    /* Initialize the bit array R */
    R = malloc((m+1) * sizeof *R);
    for (k=1; k &lt;= m; ++k)
      R[k] = 0;
    R[0] = 1;

    for (i=0; text[i] != '\0'; ++i)
    {
        /* Update the bit array */
        for (k=m; k &gt;= 1; --k)
          R[k] = R[k-1] &amp;&amp; (text[i] == pattern[k-1]);

        if (R[m]) {
            result = (text+i - m) + 1;
            break;
        }
    }

    free(R);
    return result;
}
</code>
</pre>
<p>Bitap distinguishes itself from other well-known string searching algorithms in its natural mapping onto simple bitwise operations, as in the following modification of the above program. Notice that in this implementation, counterintuitively, each bit with value&#160;zero indicates a match, and each bit with value&#160;1 indicates a non-match. The same algorithm can be written with the intuitive semantics for 0 and 1, but in that case we must introduce another instruction into the <a href="../../../i/n/n/Inner_loop.html" title="Inner loop">inner loop</a> to set <code>R |= 1</code>. In this implementation, we take advantage of the fact that left-shifting a value shifts in zeros on the right, which is precisely the behavior we need.</p>
<p>Notice also that we require <code>CHAR_MAX</code> additional bitmasks in order to convert the <code>(text[i] == pattern[k-1])</code> condition in the general implementation into bitwise operations. Therefore, the bitap algorithm performs better when applied to inputs over smaller alphabets.</p>
<pre>
<code>#include &lt;string.h&gt;
#include &lt;limits.h&gt;

const char *bitap_bitwise_search(const char *text, const char *pattern)
{
    int m = strlen(pattern);
    unsigned long R;
    unsigned long pattern_mask[CHAR_MAX+1];
    int i;

    if (pattern[0] == '\0') return text;
    if (m &gt; 31) return "The pattern is too long!";
 
    /* Initialize the bit array R */
    R = ~1;

    /* Initialize the pattern bitmasks */
    for (i=0; i &lt;= CHAR_MAX; ++i)
      pattern_mask[i] = ~0;
    for (i=0; i &lt; m; ++i)
      pattern_mask[pattern[i]] &amp;= ~(1UL &lt;&lt; i);

    for (i=0; text[i] != '\0'; ++i)
    {
        /* Update the bit array */
        R |= pattern_mask[text[i]];
        R &lt;&lt;= 1;

        if (0 == (R &amp; (1UL &lt;&lt; m)))
          return (text+i - m) + 1;
    }

    return NULL;
}
</code>
</pre>
<p><a name="Fuzzy_searching" id="Fuzzy_searching"></a></p>
<h2><span class="editsection">[<a href="../../../b/i/t/Bitap_algorithm.html" title="Edit section: Fuzzy searching">edit</a>]</span> <span class="mw-headline">Fuzzy searching</span></h2>
<p>To perform fuzzy string searching using the bitap algorithm, it is necessary to extend the bit array <i>R</i> into a second dimension. Instead of having a single array <i>R</i> that changes over the length of the text, we now have <i>k</i> distinct arrays <i>R</i><sub>1..<i>k</i></sub>. Array <i>R<sub>i</sub></i> holds a representation of the prefixes of <i>pattern</i> that match any suffix of the current string with <i>k</i> or fewer errors. In this context, an "error" may be an insertion, deletion, or substitution; see <a href="../../../l/e/v/Levenshtein_distance.html" title="Levenshtein distance">Levenshtein distance</a> for more information on these operations.</p>
<p>The implementation below performs fuzzy matching (returning the first match with up to <i>k</i> errors) using the fuzzy bitap algorithm. However, it only pays attention to substitutions, not to insertions or deletions. As before, the semantics of 0 and 1 are reversed from their intuitive meanings.</p>
<pre>
<code>#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;limits.h&gt;

const char *bitap_fuzzy_bitwise_search(const char *text, const char *pattern, int k)
{
    const char *result = NULL;
    int m = strlen(pattern);
    unsigned long *R;
    unsigned long pattern_mask[CHAR_MAX+1];
    int i, d;

    if (pattern[0] == '\0') return text;
    if (m &gt; 31) return "The pattern is too long!";

    /* Initialize the bit array R */
    R = malloc((k+1) * sizeof *R);
    for (i=0; i &lt;= k; ++i)
      R[i] = ~1;

    /* Initialize the pattern bitmasks */
    for (i=0; i &lt;= CHAR_MAX; ++i)
      pattern_mask[i] = ~0;
    for (i=0; i &lt; m; ++i)
      pattern_mask[pattern[i]] &amp;= ~(1UL &lt;&lt; i);

    for (i=0; text[i] != '\0'; ++i)
    {
        /* Update the bit arrays */
        unsigned long old_Rd1 = R[0];

        R[0] |= pattern_mask[text[i]];
        R[0] &lt;&lt;= 1;

        for (d=1; d &lt;= k; ++d) {
            unsigned long tmp = R[d];
            /* Substitution is all we care about */
            R[d] = (old_Rd1 &amp; (R[d] | pattern_mask[text[i]])) &lt;&lt; 1;
            old_Rd1 = tmp;
        }

        if (0 == (R[k] &amp; (1UL &lt;&lt; m))) {
            result = (text+i - m) + 1;
            break;
        }
    }

    return result;
}
</code>
</pre>
<p><a name="External_links_and_references" id="External_links_and_references"></a></p>
<h2><span class="editsection">[<a href="../../../b/i/t/Bitap_algorithm.html" title="Edit section: External links and references">edit</a>]</span> <span class="mw-headline">External links and references</span></h2>
<ol>
<li><cite id="endnote_Manber91" style="font-style: normal;"><a href="#ref_Manber91" title=""><b>^</b></a></cite>&#160; Udi Manber, Sun Wu. "Fast text searching with errors." Technical Report TR-91-11. Department of Computer Science, <a href="../../../u/n/i/University_of_Arizona_07d8.html" title="University of Arizona">University of Arizona</a>, Tucson, June 1991. (<a href="ftp://ftp.cs.arizona.edu/agrep/agrep.ps.1.Z" class="external text" title="ftp://ftp.cs.arizona.edu/agrep/agrep.ps.1.Z" rel="nofollow">gzipped PostScript</a>)</li>
<li><cite id="endnote_Manber92" style="font-style: normal;"><a href="#ref_Manber92" title=""><b>^</b></a></cite>&#160; Udi Manber, Sun Wu. "Fast text search allowing errors." <i><a href="../../../c/o/m/Communications_of_the_ACM_7add.html" title="Communications of the ACM">Communications of the ACM</a></i>, 35(10), October 1992.</li>
<li><cite id="endnote_BYG89" style="font-style: normal;"><a href="#ref_BYG89" title=""><b>^</b></a></cite>&#160; Ricardo A. Baeza-Yates, Gastón H. Gonnet. "A New Approach to Text Searching." <i>Communications of the ACM</i>, 35(10): pp. 74–82, October 1992.</li>
<li><cite id="endnote_BN96" style="font-style: normal;"><a href="#ref_BN96" title=""><b>^</b></a></cite>&#160; R. Baeza-Yates and G. Navarro. A faster algorithm for approximate string matching. In Dan Hirchsberg and Gene Myers, editors, Combinatorial Pattern Matching (CPM'96), LNCS 1075, pages 1--23, Irvine, CA, Jun 1996.</li>
<li><cite id="endnote_M99" style="font-style: normal;"><a href="#ref_M99" title=""><b>^</b></a></cite>&#160; G. Myers. A fast bit-vector algorithm for approximate string matching based on dynamic programming, Journal of the ACM (JACM) 46 (3), May 1999, 395 - 415.</li>
<li><a href="http://www.rational.co.za/libbitap/" class="external text" title="http://www.rational.co.za/libbitap/" rel="nofollow">Libbitap</a>, a free implementation that shows how the algorithm can easily be extended for most regular expressions. Unlike the code above, it places no limit on the pattern length.</li>
<li>Baeza-Yates. <i>Modern Information Retrieval</i>. <a href="../../../b/o/o/Special%7EBooksources_ed7b.html" class="internal">ISBN 0-201-39829-X</a>.</li>
</ol>

<!-- 
Pre-expand include size: 6448 bytes
Post-expand include size: 1364 bytes
Template argument size: 140 bytes
Maximum: 2048000 bytes
-->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html">http://en.wikipedia.org../../../b/i/t/Bitap_algorithm.html</a>"</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="../../../a/l/g/Category%7EAlgorithms_on_strings_0457.html" title="Category:Algorithms on strings">Algorithms on strings</a></span> | <span dir='ltr'><a href="../../../s/e/a/Category%7ESearch_algorithms_e191.html" title="Category:Search algorithms">Search algorithms</a></span> | <span dir='ltr'><a href="../../../a/r/t/Category%7EArticles_with_example_C_code_0fd2.html" title="Category:Articles with example C code">Articles with example C code</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="../../../b/i/t/Bitap_algorithm.html">Article</a></li><li id="ca-talk"
	       	       ><a href="../../../b/i/t/Talk%7EBitap_algorithm_5f20.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/Bitap_algorithm">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	<div id="p-lang" class="portlet">
	  <h5>In other languages</h5>
	  <div class="pBody">
	    <ul>
	      	      <li>
	      <a href="../../../../de/b/a/e/Baeza-Yates-Gonnet-Algorithmus_70d8.html">Deutsch</a>
	      </li>
	      	    </ul>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 19:19, 1 February 2007 by Wikipedia user <a href="../../../r/u/u/User%7ERuud_Koot_88b0.html" title="User:Ruud Koot">Ruud Koot</a>. Based on work by Wikipedia user(s) <a href="../../../q/u/u/User%7EQuuxplusone_9b50.html" title="User:Quuxplusone">Quuxplusone</a>, <a href="../../../g/w/e/User%7EGwern_2189.html" title="User:Gwern">Gwern</a>, Ltickett, <a href="../../../w/o/o/User%7EWoohookitty_27d9.html" title="User:Woohookitty">Woohookitty</a>, <a href="../../../s/a/f/User%7ESaforrest_5781.html" title="User:Saforrest">Saforrest</a>, Itman, <a href="../../../n/r/o/User%7ENroets_0d94.html" title="User:Nroets">Nroets</a>, <a href="../../../s/t/e/User%7EStern_3613.html" title="User:Stern">Stern</a>, <a href="../../../g/r/e/User%7EGregorB_c220.html" title="User:GregorB">GregorB</a> and <a href="../../../c/h/a/User%7ECharles_Matthews_cceb.html" title="User:Charles Matthews">Charles Matthews</a> and Anonymous user(s) of Wikipedia.</li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
