<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="User:AzaToth/twinklearv.js,Bypass your cache" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>User:AzaToth/twinklearv.js - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-2">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">User:AzaToth/twinklearv.js</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"><span class="subpages">&lt; <a href="../../../a/z/a/User%7EAzaToth_9bb9.html" title="User:AzaToth">User:AzaToth</a></span></div>
	    	    <div class="usermessage">You have <a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">new messages</a> (<a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">last change</a>).</div>	    <!-- start content -->
	    <p><span id="clearyourcache"><b>Note:</b> After saving, you have to <a href="../../../b/y/p/Wikipedia%7EBypass_your_cache_1dae.html" title="Wikipedia:Bypass your cache">bypass your browser's cache</a> to see the changes. <b>Firefox/Mozilla/Safari:</b> hold down <i>Shift</i> while clicking <i>Reload</i> (or press <i>Ctrl-Shift-R</i>), <b>Internet Explorer:</b> press <i>Ctrl-F5</i>, <b>Opera/Konqueror:</b> press <i>F5</i>. 
</span>
</p><pre>// If TwinkleConfig aint exist.
if( typeof( TwinkleConfig ) == 'undefined' ) {
	TwinkleConfig = {};
}

/**
TwinkleConfig.summaryAd (string)
If ad should be added or not to summary, default [[WP:TWINKLE|TWINKLE]]
*/
if( typeof( TwinkleConfig.summaryAd ) == 'undefined' ) {
	TwinkleConfig.summaryAd = &quot; using [[WP:TWINKLE|TW]]&quot;;
}

/**
 TwinkleConfig.markAIVReportAsMinor (boolean)
 Defines if a reports to AIV should be marked as minor, if false, default is applied as per preference.
*/
if( typeof( TwinkleConfig.markAIVReportAsMinor ) == 'undefined' ) {
	TwinkleConfig.markAIVReportAsMinor = true;
}

/**
 TwinkleConfig.confirmUsernameToAIV (boolean)
 Defines if a username reports to AIV should be confirmed before sent.
*/
if( typeof( TwinkleConfig.confirmUsernameToAIV ) == 'undefined' ) {
	TwinkleConfig.confirmUsernameToAIV = true;
}


// Twinklefluff vandalsim reporting tool
// Orignallity an updated version of ARV 2.1, but nut much code left from that day now

//Status.debugLevel = 1;
var AIVpageName = 'Wikipedia:Administrator_intervention_against_vandalism';
var section = '1';

var xmlObject;

addOnloadHook( twinkleARVBase );
function twinkleARVBase(){
	var username;


	if ( wgNamespaceNumber == 3 || wgNamespaceNumber == 2 || ( wgNamespaceNumber == -1 &amp;&amp; wgTitle == &quot;Contributions&quot; )){

		// If we are on the contributions page, need to parse some then
		if( wgNamespaceNumber == -1 &amp;&amp; wgTitle == &quot;Contributions&quot; ) {
			username = document.getElementById( 'contentSub' ).getElementsByTagName( 'a' )[0].getAttribute('title').split(':')[1];
		} else {
			username = wgTitle.split( '/' )[0]; // only first part before any slashes
		}

		if( !username ) {
			// Something is fishy, there was no user? lets about everything
			throw &quot;given username was &quot; + username + &quot; and thus makes no sense.&quot;;
		}

		var name = 'Report';
		var title = 'Report user to AIV';

		if( isIPAddress( username ) ) {
			name = 'Report IP';
			title = 'Report IP to AIV';
		}

		var tabs = document.getElementById('p-cactions').getElementsByTagName('ul')[0];
		addlimenu(tabs, name, 'ca-report' );
		addPortletLink( 'ca-report', 'javascript:twinklearv( &quot;' + username + '&quot; )' , name , 'td-report', title, '' );
		addPortletLink( 'ca-report', 'javascript:twinklearv( &quot;' + username + '&quot;, &quot;final&quot; )' , 'final' , 'ca-report-final', title + ' (final warning already given)', '' );
		addPortletLink( 'ca-report', 'javascript:twinklearv( &quot;' + username + '&quot;, &quot;postblock&quot; )' , 'post block' , 'ca-report-postblock', title + ' (vandalism after release of block)', '' );
		addPortletLink( 'ca-report', 'javascript:twinklearv( &quot;' + username + '&quot;, &quot;sock&quot; )' , 'sock puppet' , 'ca-report-sock', title + ' (Account is a sock puppet account)', '' );
		if( !isIPAddress( username ) ) {
			addPortletLink( 'ca-report', 'javascript:twinklearv( &quot;' + username + '&quot;, &quot;username&quot; )' , 'username' , 'ca-report-username', title + ' (inflammatory username)', '' );
			addPortletLink( 'ca-report', 'javascript:twinklearv( &quot;' + username + '&quot;, &quot;vandalonly&quot; )' , 'vandal only' , 'ca-report-vandalonly', title + ' (vandalism only account)', '' );
		}
	}
}

function twinklearv( vandal, final ){
	twinklearv.vandal = vandal;
	final = final || false;

	if( vandal == wgUserName ){
		alert( 'You don\'t want to report yourself , do you?' );
		return;
	}


	if( final ) {
		twinklearv.reason = 'Vandalism';

		if( QueryString.exists( 'vanarticle' ) ) {
			twinklearv.reason += ' on [[' + QueryString.get( 'vanarticle' ).replace( /^(Image|Category):/i, ':$1:' ) + ']]';

			if( QueryString.exists( 'vanarticlerevid' ) ) {
				var query = {
					'title': QueryString.get( 'vanarticle' ),
					'diff': QueryString.get( 'vanarticlerevid' ),
					'oldid': QueryString.exists( 'vanarticlegoodrevid' ) ? QueryString.get( 'vanarticlegoodrevid' )  : 'prev'
				};
				twinklearv.reason += '  ([' +  wgServer + wgScriptPath + '/index.php?' + QueryString.create( query ) + ' diff])';
			}
		}
		switch( final ) {
			case 'final':
			twinklearv.reason += ' after final warning.';
			break;
			case 'postblock':
			twinklearv.reason += ' after release of block.';
			break;
			case 'username':
			if( TwinkleConfig.confirmUsernameToAIV &amp;&amp; !confirm( &quot;This will report the username to WP:AIV as blatantly inappropriate. Usernames should only be reported at AIV if they are clearly rude, inflammatory, unnecessarily long or confusing, too similar to an existing user, contain the name of an organization or website, or are otherwise inappropriate. Borderline cases should be reported manually at WP:RFCN. Do you still want to report the username at AIV?&quot; ) ) {
				return;
			}
			twinklearv.reason = 'Username is a clear violation of the [[WP:USERNAME|username policy]].';
			break;
			case 'vandalonly':
			twinklearv.reason += ', contributions indicate vandalism-only account.';
			break;
			case 'sock':
			var sock = prompt( 'Please enter the username of the sock puppeteer if possible.');
			if( sock == null ) {
				return;
			}
			twinklearv.reason += ', contributions indicate account as a sock puppet account' + ( sock ? ' of sock puppeteer {{userlinks|' + sock + '}}' : '' ) + '.';
		}

	} else if( ( twinklearv.reason = prompt( 'Reason:' ) ) == null ) {
		return;
	}

	Status.init( document.getElementById( 'bodyContent' ) );

	Status.status( &quot;Please wait...&quot; );
	Status.debug( 'Initiating xmlObject' );

	xmlObject = sajax_init_object();
	xmlObject.overrideMimeType('text/xml');

	if ( !xmlObject ) {
		Status.error( &quot;Unable to open XML Request object , bailing out.&quot; );
		return false;
	}

	Status.status( &quot;Grabbing page&quot; );

	var query = {
		'title': AIVpageName,
		'action': 'submit',
		'section': section
	};

	xmlObject.open( 'GET' , wgServer + wgScriptPath + '/index.php?' + QueryString.create( query ), true );
	xmlObject.onreadystatechange = function() {
		var vandal = twinklearv.vandal;
		var reason = twinklearv.reason;

		if( xmlObject.readyState != 4 ) {
			Status.progress( '.' );
			return;
		}

		if( xmlObject.status != 200 ) {
			Status.error( 'Bad status. bailing out.' );
			return;
		}

		var doc = xmlObject.responseXML;

		var form = doc.getElementById( 'editform' );
		var textbox = doc.getElementById( 'wpTextbox1' );
		var summary = doc.getElementById( 'wpSummary' );

		form.style.display = 'none';

		Status.status( 'Searching for existing report...' );

		var re = new RegExp( &quot;\\{\\{\\s*(?:(?:[Ii][Pp])?[Vv]andal|[Uu]serlinks)\\s*\\|\\s*(?:1=)?\\s*&quot; + RegExp.escape( vandal, true ) + &quot;\\s*\\}\\}&quot; );

		var myArr;
		if( ( myArr = re.exec( textbox.value ) ) ) {
			Status.debug( 'match: ' + myArr[0] );

			Status.info( 'Report already present, will not add a new one' );
			return;
		}

		Status.status( 'Adding new report...' );

		textbox.value += '*{{' + ( isIPAddress( vandal ) ? 'IPvandal' : 'vandal' ) + '|' + (/\=/.test( vandal ) ? '1=' : '' ) + vandal + '}} - ' + reason + ' ~~' + '~~';

		summary.value = 'Reporting [[Special:Contributions/' + vandal + '|' + vandal + ']].'+ TwinkleConfig.summaryAd;	

		if( TwinkleConfig.markAIVReportAsMinor ) {
			doc.getElementById( 'wpMinoredit' ).checked = true;
		}

		Status.status( 'Submitting form...' );

		document.getElementById('globalWrapper').appendChild( form );
		form.submit();	

	}
	xmlObject.send( null );
}
</pre><div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../a/z/a/User%7EAzaToth_twinklearv.js_fa4f.html">http://en.wikipedia.org../../../a/z/a/User%7EAzaToth_twinklearv.js_fa4f.html</a>"</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-user"
	       class="selected"	       ><a href="../../../a/z/a/User%7EAzaToth_twinklearv.js_fa4f.html">User page</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../a/z/a/User_talk%7EAzaToth_twinklearv.js_4a8b.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/User:AzaToth/twinklearv.js">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 01:57, 20 March 2007 by Wikipedia user <a href="../../../a/z/a/User%7EAzaToth_9bb9.html" title="User:AzaToth">AzaToth</a>. </li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
