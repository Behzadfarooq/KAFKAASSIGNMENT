<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="AA tree,2-3-4 tree,2-3 tree,AVL tree,B-tree,C (programming language),Computer science,Red-black tree,Citing sources" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>AA tree - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-0">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">AA tree</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"></div>
	    	    <div class="usermessage">You have <a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">new messages</a> (<a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">last change</a>).</div>	    <!-- start content -->
	    <p>An <b>Arne Andersson tree</b> (<b>AA tree</b>) in <a href="../../../c/o/m/Computer_science.html" title="Computer science">computer science</a> is a <a href="../../../r/e/d/Red-black_tree.html" title="Red-black tree">red-black tree</a> with one additional rule. Unlike red-black trees, RED nodes on an AA tree can only be added as a right subchild. In other words, no RED node can be a left subchild. This results in the simulation of a <a href="../../../2/-/3/2-3_tree.html" title="2-3 tree">2-3 tree</a> instead of a <a href="../../../2/-/3/2-3-4_tree.html" title="2-3-4 tree">2-3-4 tree</a>, which greatly simplifies the maintenance operations. The maintenance algorithms for a red-black tree need to consider seven different shapes to properly balance the tree:</p>
<pre>
*       *     *     *       *       *   *
 \     /     / \     \     /       /     \
  *   *     *   *     *   *       *       *
                     /     \     /         \
                    *       *   *           *
</pre>
<p>An AA tree on the other hand only needs to consider two shapes due to the strict requirement that only right links can be red:</p>
<pre>
*     *
 \     \
  *     *
         \
          *
</pre>
<p>For the discussion below (which is also the traditional way to implement AA trees), we are going to assume every node has a variable called 'level' which stores the number of left links that must be followed until we reach the 'null' pointer. This means the level of each leaf is one. A complete set of the requirements for an AA tree can now be defined&#160;:</p>
<ol>
<li>Every node of level greater than one must have a right child with its level either being equal to, or being one less than the level of the node.</li>
<li>When a node has a grandchild, it may not have the same level.</li>
</ol>
<p>Only two operations are needed for maintaining balance in an AA tree. These operations are called skew and split. Skew is a right rotation when an insertion or deletion creates a left red link. Split is a conditional left rotation when an insertion or deletion creates two consecutive red links.</p>
<pre>
 void Skew (struct node *oldparent)
 {
   struct node *newp = oldparent-&gt;left;
 
   if (oldparent-&gt;parent-&gt;left == oldparent) oldparent-&gt;parent-&gt;left = newp;
   else oldparent-&gt;parent-&gt;right = newp;
   newp-&gt;parent = oldparent-&gt;parent;
   oldparent-&gt;parent = newp;
 
   oldparent-&gt;left = newp-&gt;right;
   if (oldparent-&gt;left) oldparent-&gt;left-&gt;parent = oldparent;
   newp-&gt;right = oldparent;
   
   oldparent-&gt;level = oldparent-&gt;left ? oldparent-&gt;left-&gt;level + 1 : 1;
 }
 
 int Split (struct node *oldparent)
 {
   struct node *newp = oldparent-&gt;right;
 
   if (newp &amp;&amp; newp-&gt;right &amp;&amp; newp-&gt;right-&gt;level == oldparent-&gt;level) { 
     if (oldparent-&gt;parent-&gt;left == oldparent) oldparent-&gt;parent-&gt;left = newp;
     else oldparent-&gt;parent-&gt;right = newp;
     newp-&gt;parent = oldparent-&gt;parent;
     oldparent-&gt;parent = newp;
   
     oldparent-&gt;right = newp-&gt;left;
     if (oldparent-&gt;right) oldparent-&gt;right-&gt;parent = oldparent;
     newp-&gt;left = oldparent;
     newp-&gt;level = oldparent-&gt;level + 1;
   return 1;
   }
   return 0;
 }
</pre>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Insertion"><span class="tocnumber">1</span> <span class="toctext">Insertion</span></a></li>
<li class="toclevel-1"><a href="#Deletion"><span class="tocnumber">2</span> <span class="toctext">Deletion</span></a></li>
<li class="toclevel-1"><a href="#Performance"><span class="tocnumber">3</span> <span class="toctext">Performance</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">5</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">6</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Insertion" id="Insertion"></a></p>
<h2><span class="editsection">[<a href="../../../a/a/_/AA_tree_fa22.html" title="Edit section: Insertion">edit</a>]</span> <span class="mw-headline">Insertion</span></h2>
<p>Insertion starts with a normal basic binary search tree insertion, after which rebalancing is performed. If a right child increases in level (either because the new node was inserted to its left, or because its left child's level increased, or because it got a new left child with a higher level) then the possibility of 2 consecutive red nodes is handled with split (which may in turn cause the level of the new parent to increase).</p>
<p>If a node's level should increase, a skew is performed. Then care must be taken because either the node's old parent (now child) or its old sibling (new grandchild) could have been a red node. Then we are back to the above situation where a split must be performed. It can all be handled nicely with a loop&#160;:</p>
<pre>
 void RebalanceAfterLeafAdd (struct node *n)
 { // n is a node that has just been inserted and is now a leaf node.
   n-&gt;level = 1;
   n-&gt;left = NULL;
   n-&gt;right = NULL;
   for (n = n-&gt;parent; n != &amp;root; n = n-&gt;parent) {
     if (n-&gt;level != (n-&gt;left ? n-&gt;left-&gt;level + 1 : 1)) {
       Skew (n);
       if (!n-&gt;right || n-&gt;level != n-&gt;right-&gt;level) n = n-&gt;parent;
     }
     if (!Split (n-&gt;parent)) break;
   }
 }
</pre>
<p>AA trees are easier to implement with a sentinel node at the end of the tree rather than a null pointer because there are fewer cases to test for, but it is relatively simple to convert sentinel code to null terminated code. Whatever is used, it only affects the implementation of skew and split.</p>
<p><a name="Deletion" id="Deletion"></a></p>
<h2><span class="editsection">[<a href="../../../a/a/_/AA_tree_fa22.html" title="Edit section: Deletion">edit</a>]</span> <span class="mw-headline">Deletion</span></h2>
<p>If the node is not a leaf node, we find one that appears just before or just after it in the ordering. The properties of an AA tree guarantees that it is possible. Then we swap the two and delete the leaf. If it was a left child, its parent's level needs to decrease and if it was a right child, we must make sure there's no double red nodes.</p>
<p>The difficult test case occurs when 7 elements (a-b-c-d-e-f-g) is stored in the tree below and we want to delete 'a'</p>
<pre>
    b,2
   /   \
 a,1   e,2
      /  \
    c,1  f,1
      \    \
      d,1  g,1
</pre>
<p>The numbers indicate the levels. After removing 'a', we split b-e-f and get</p>
<pre>
    e,2
   /   \
 b,1   f,1
   \     \
  c,1    g,1
     \
     d,1
</pre>
<p>Then we split b-c-d and get</p>
<pre>
     e,2
    /   \
  c,2   f,1
 /   \    \
b,1  d,1  g,1
</pre>
<p>Then we finish by skewing c-e-f&#160;:</p>
<pre>
     c,2
    /   \
  b,1   e,2
       /  \
     d,1  f,1
            \
           g,1
</pre>
<p>The complete algorithm in <a href="../../../c/_/%28/C_%28programming_language%29.html" title="C (programming language)">C</a> looks like this&#160;:</p>
<pre>
 void Remove (struct node *n)
 { 
   struct node *leaf = n, *tmp;
 
   if (n-&gt;left) {
     for (leaf = n-&gt;left; leaf-&gt;right; leaf = leaf-&gt;right) {}
   }
   else if (n-&gt;right) leaf = n-&gt;right;
 
   tmp = leaf-&gt;parent == n ? leaf : leaf-&gt;parent;
   if (leaf-&gt;parent-&gt;left == leaf) leaf-&gt;parent-&gt;left = NULL;
   else leaf-&gt;parent-&gt;right = NULL;
 
   if (n != leaf) {
     if (n-&gt;parent-&gt;left == n) n-&gt;parent-&gt;left = leaf;
     else n-&gt;parent-&gt;right = leaf;
     leaf-&gt;parent = n-&gt;parent;
     if (n-&gt;left) n-&gt;left-&gt;parent = leaf;
     leaf-&gt;left = n-&gt;left;
     if (n-&gt;right) n-&gt;right-&gt;parent = leaf;
     leaf-&gt;right = n-&gt;right;
     leaf-&gt;level = n-&gt;level;
   }
 
   for (; tmp != &amp;root; tmp = tmp-&gt;parent) {
     if (tmp-&gt;level &gt; (tmp-&gt;left ? tmp-&gt;left-&gt;level + 1 : 1)) {
       tmp-&gt;level--;
       if (Split (tmp)) {
         if (Split (tmp)) Skew (tmp-&gt;parent-&gt;parent);
         break;
       }
     }
     else if (tmp-&gt;level &lt;= (tmp-&gt;right ? tmp-&gt;right-&gt;level + 1 : 1)) break;
     else {
       Skew (tmp);
       if (tmp-&gt;level &gt; tmp-&gt;parent-&gt;level) {
         Skew (tmp);
         Split (tmp-&gt;parent-&gt;parent);
         break;
       }
       tmp = tmp-&gt;parent;
     }
   }
 }
</pre>
<p><a name="Performance" id="Performance"></a></p>
<h2><span class="editsection">[<a href="../../../a/a/_/AA_tree_fa22.html" title="Edit section: Performance">edit</a>]</span> <span class="mw-headline">Performance</span></h2>
<p>The performance of an AA tree is equivalent to the performance of a red-black tree. While an AA tree makes more rotations than a red-black tree, the simpler algorithms tend to be faster, and all of this balances out to result in similar performance. A red-black tree is more consistent in its performance than an AA tree, but an AA tree tends to be flatter, which results in slightly faster search times.<sup class="noprint Template-Fact"><a href="../../../c/i/t/Wikipedia%7ECiting_sources_8ba4.html" title="Wikipedia:Citing sources"><span title="This claim needs references to reliable sources since February 2007" style="white-space: nowrap;">[<i>citation needed</i>]</span></a></sup></p>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="../../../a/a/_/AA_tree_fa22.html" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="../../../r/e/d/Red-black_tree.html" title="Red-black tree">Red-black tree</a></li>
<li><a href="../../../b/-/t/B-tree.html" title="B-tree">B-tree</a></li>
<li><a href="../../../a/v/l/AVL_tree_532e.html" title="AVL tree">AVL tree</a></li>
</ul>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="../../../a/a/_/AA_tree_fa22.html" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ul>
<li><a href="http://www.rational.co.za/aatree.c" class="external text" title="http://www.rational.co.za/aatree.c" rel="nofollow">Complete sourcecode for the above</a></li>
<li><a href="http://user.it.uu.se/~arnea/abs/simp.html" class="external text" title="http://user.it.uu.se/~arnea/abs/simp.html" rel="nofollow">A. Andersson. Balanced search trees made simple</a></li>
<li><a href="http://user.it.uu.se/~arnea/abs/searchproc.html" class="external text" title="http://user.it.uu.se/~arnea/abs/searchproc.html" rel="nofollow">A. Andersson. A note on searching in a binary search tree</a></li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="../../../a/a/_/AA_tree_fa22.html" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_andersson.aspx" class="external text" title="http://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_andersson.aspx" rel="nofollow">Thorough tutorial with lots of code</a></li>
<li><a href="http://www.eternallyconfuzzled.com/libs/jsw_atree.zip" class="external text" title="http://www.eternallyconfuzzled.com/libs/jsw_atree.zip" rel="nofollow">Practical implementation</a></li>
</ul>

<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../a/a/_/AA_tree_fa22.html">http://en.wikipedia.org../../../a/a/_/AA_tree_fa22.html</a>"</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="../../../a/r/t/Category%7EArticles_with_unsourced_statements_since_February_2007_f7dc.html" title="Category:Articles with unsourced statements since February 2007">Articles with unsourced statements since February 2007</a></span> | <span dir='ltr'><a href="../../../a/l/l/Category%7EAll_articles_with_unsourced_statements_2f67.html" title="Category:All articles with unsourced statements">All articles with unsourced statements</a></span> | <span dir='ltr'><a href="../../../t/r/e/Category%7ETrees_%28structure%29_77fb.html" title="Category:Trees (structure)">Trees (structure)</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="../../../a/a/_/AA_tree_fa22.html">Article</a></li><li id="ca-talk"
	       	       ><a href="../../../a/a/_/Talk%7EAA_tree_d5db.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/AA_tree">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 20:50, 9 February 2007 by Wikipedia user <a href="../../../m/o/n/User%7EMONGO_8e88.html" title="User:MONGO">MONGO</a>. Based on work by Wikipedia user(s) <a href="../../../s/m/a/User%7ESmackBot_cc7a.html" title="User:SmackBot">SmackBot</a>, <a href="../../../c/m/d/User%7ECmdrObot_0605.html" title="User:CmdrObot">CmdrObot</a>, Floodyberry, <a href="../../../q/u/t/User%7EQutezuce_4fd6.html" title="User:Qutezuce">Qutezuce</a>, <a href="../../../g/w/e/User%7EGwern_2189.html" title="User:Gwern">Gwern</a>, <a href="../../../o/p/t/User%7EOptikos_6dff.html" title="User:Optikos">Optikos</a>, HyperQuantum, <a href="../../../t/r/i/User%7ETriona_934d.html" title="User:Triona">Triona</a>, <a href="../../../f/i/r/User%7EFirsfron_bff1.html" title="User:Firsfron">Firsfron</a>, <a href="../../../n/r/o/User%7ENroets_0d94.html" title="User:Nroets">Nroets</a>, <a href="../../../d/a/m/User%7EDamian_Yerrick_2a18.html" title="User:Damian Yerrick">Damian Yerrick</a>, RobertG, Confuzzled, <a href="../../../g/a/z/User%7EGazpacho_8dfc.html" title="User:Gazpacho">Gazpacho</a>, <a href="../../../r/j/f/User%7ERJFJR_0643.html" title="User:RJFJR">RJFJR</a>, <a href="../../../d/c/o/User%7EDcoetzee_a2a7.html" title="User:Dcoetzee">Dcoetzee</a> and <a href="../../../c/h/a/User%7ECharles_Matthews_cceb.html" title="User:Charles Matthews">Charles Matthews</a> and Anonymous user(s) of Wikipedia.</li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
