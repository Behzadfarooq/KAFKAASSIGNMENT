<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="Automatic differentiation,Algebra,Analytic functions,Arithmetic,Backpropagation,Chain rule,Computational complexity theory,Computer algebra,Derivative,Discretization,Dual numbers" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>Automatic differentiation - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-0">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Automatic differentiation</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p>In <a href="../../../m/a/t/Mathematics.html" title="Mathematics">mathematics</a> and <a href="../../../c/o/m/Computer_algebra.html" title="Computer algebra">computer algebra</a>, <b>automatic differentiation</b>, or AD, sometimes alternatively called <b>algorithmic differentiation</b>, is a method to numerically evaluate the <a href="../../../d/e/r/Derivative.html" title="Derivative">derivative</a> of a function specified by a computer program. Two classical ways of doing differentiation are:</p>
<div class="thumb tright">
<div class="thumbinner" style="width:302px;"><a href="../../../a/u/t/Image%7EAutomaticDifferentiationNutshell.png_0a48.html" class="internal" title="Figure 1: How automatic differentiation relates to symbolic differentiation"><img src="../../../upload/thumb/3/3c/AutomaticDifferentiationNutshell.png/300px-AutomaticDifferentiationNutshell.png" alt="Figure 1: How automatic differentiation relates to symbolic differentiation" width="300" height="121" longdesc="../../../a/u/t/Image%7EAutomaticDifferentiationNutshell.png_0a48.html" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify" style="float:right"><a href="../../../a/u/t/Image%7EAutomaticDifferentiationNutshell.png_0a48.html" class="internal" title="Enlarge"><img src="../../../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
Figure 1: How automatic differentiation relates to symbolic differentiation</div>
</div>
</div>
<ul>
<li>symbolically differentiate the function as an expression, and evaluate it in the point; or</li>
<li>use <a href="../../../n/u/m/Numerical_differentiation.html" title="Numerical differentiation">numerical differentiation</a>.</li>
</ul>
<p>The drawback with symbolic differentiation is low speed, and the difficulty of converting a computer program into a single expression. Moreover, many functions grow quite complex as higher derivatives are calculated. Two important drawbacks with finite differences are <a href="../../../r/o/u/Round-off_error.html" title="Round-off error">round-off errors</a> in the <a href="../../../d/i/s/Discretization.html" title="Discretization">discretization</a> process, and cancellation. Both classical methods have problems with calculating higher derivatives, where the complexity and errors increase. Automatic differentiation solves all of the mentioned problems.</p>
<p>AD exploits the fact that any computer program that implements a vector function <b>y</b> = F(<b>x</b>) (generally) can be decomposed into a sequence of elementary assignments, any one of which may be trivially differentiated by a simple table lookup. These <i>elemental partial derivatives</i>, evaluated at a particular argument, are combined in accordance with the <a href="../../../c/h/a/Chain_rule.html" title="Chain rule">chain rule</a> from derivative calculus to form some derivative information for F (such as <a href="../../../g/r/a/Gradient.html" title="Gradient">gradients</a>, <a href="../../../t/a/n/Tangent.html" title="Tangent">tangents</a>, the <a href="../../../j/a/c/Jacobian.html" title="Jacobian">Jacobian</a> matrix, etc.). This process yields exact (to numerical accuracy) derivatives. Because the symbolic transformation occurs only at the most basic level, AD avoids the computational problems inherent in complex symbolic computation.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Derivation_of_augmented_arithmetic_for_Forward-Mode_AD_using_dual_numbers"><span class="tocnumber">1</span> <span class="toctext">Derivation of augmented arithmetic for Forward-Mode AD using dual numbers</span></a>
<ul>
<li class="toclevel-2"><a href="#Vector_arguments_and_functions"><span class="tocnumber">1.1</span> <span class="toctext">Vector arguments and functions</span></a></li>
<li class="toclevel-2"><a href="#Higher_order_differentials"><span class="tocnumber">1.2</span> <span class="toctext">Higher order differentials</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#The_chain_rule.2C_forward_and_reverse_accumulation"><span class="tocnumber">2</span> <span class="toctext">The chain rule, forward and reverse accumulation</span></a>
<ul>
<li class="toclevel-2"><a href="#Forward_accumulation"><span class="tocnumber">2.1</span> <span class="toctext">Forward accumulation</span></a></li>
<li class="toclevel-2"><a href="#Reverse_accumulation"><span class="tocnumber">2.2</span> <span class="toctext">Reverse accumulation</span></a></li>
<li class="toclevel-2"><a href="#Jacobian_computation"><span class="tocnumber">2.3</span> <span class="toctext">Jacobian computation</span></a></li>
<li class="toclevel-2"><a href="#Beyond_forward_and_reverse_accumulation"><span class="tocnumber">2.4</span> <span class="toctext">Beyond forward and reverse accumulation</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Implementation"><span class="tocnumber">3</span> <span class="toctext">Implementation</span></a>
<ul>
<li class="toclevel-2"><a href="#Source_code_transformation"><span class="tocnumber">3.1</span> <span class="toctext">Source code transformation</span></a></li>
<li class="toclevel-2"><a href="#Operator_overloading"><span class="tocnumber">3.2</span> <span class="toctext">Operator overloading</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">5</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Derivation_of_augmented_arithmetic_for_Forward-Mode_AD_using_dual_numbers" id="Derivation_of_augmented_arithmetic_for_Forward-Mode_AD_using_dual_numbers"></a></p>
<h2><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Derivation of augmented arithmetic for Forward-Mode AD using dual numbers">edit</a>]</span> <span class="mw-headline">Derivation of augmented arithmetic for Forward-Mode AD using dual numbers</span></h2>
<p>Forward-Mode Automatic Differentiation is accomplished by augmenting the <a href="../../../a/l/g/Algebra.html" title="Algebra">algebra</a> of <a href="../../../r/e/a/Real_numbers.html" title="Real numbers">real numbers</a> and obtaining a new <a href="../../../a/r/i/Arithmetic.html" title="Arithmetic">arithmetic</a>. An additional component is added to every number which will represent the derivative of a function at the number, and all arithmetic operators are extended for the augmented algebra. The augmented algebra is the algebra of <a href="../../../d/u/a/Dual_numbers.html" title="Dual numbers">dual numbers</a>.</p>
<p>Replace every number <img class='tex' src="../../../math/c/9/b/c9b156d8b2ef3e299acca75219990b56.png" alt="\,x" /> with the number <img class='tex' src="../../../math/9/c/d/9cd82defa7d310c603b57e2daa61836c.png" alt="x + x'\varepsilon" />, where <span class="texhtml"><i>x</i>'</span> is a real number, but <img class='tex' src="../../../math/c/6/9/c691dc52cc1ad756972d4629934d37fd.png" alt="\varepsilon" /> is nothing but a symbol with the property <img class='tex' src="../../../math/6/0/6/606e9aa22280d10afeec68c2c8148773.png" alt="\varepsilon^2=0" />. Using only this, we get for the regular arithmetic</p>
<dl>
<dd><img class='tex' src="../../../math/6/f/c/6fce25e0d437d65ffc45fb2d1611c648.png" alt="(x + x'\varepsilon) + (y + y'\varepsilon) = x + y + (x' + y')\varepsilon" /></dd>
<dd><img class='tex' src="../../../math/d/4/5/d45a635c0e121f0871151103fd96cd1c.png" alt="(x + x'\varepsilon) \cdot (y + y'\varepsilon) = xy + xy'\varepsilon + yx'\varepsilon + \dot{x}y'\varepsilon^2 = xy + (x y' + yx')\varepsilon" /></dd>
</dl>
<p>and likewise for subtraction and division.</p>
<p>Now, we may calculate <a href="../../../p/o/l/Polynomials.html" title="Polynomials">polynomials</a> in this augmented arithmetic. If <img class='tex' src="../../../math/4/4/f/44f087225c272805d0de3aef3363783b.png" alt="P(x) = p_0 + p_1 x + p_2x^2 + \cdots + p_n x^n" />, then</p>
<table>
<tr>
<td><img class='tex' src="../../../math/8/3/3/8339270746783d7cf5392763501ca96d.png" alt="P(x + x'\varepsilon)" /></td>
<td><img class='tex' src="../../../math/4/4/8/4488ba5f7e82e2d8c136b559d95283d5.png" alt="=\," /></td>
<td><img class='tex' src="../../../math/8/8/e/88e6e8d60a32dfc3e2834badcb1188fa.png" alt="p_0 + p_1(x + x'\varepsilon) + \cdots + p_n (x + x'\varepsilon)^n" /></td>
</tr>
<tr>
<td></td>
<td><img class='tex' src="../../../math/4/4/8/4488ba5f7e82e2d8c136b559d95283d5.png" alt="=\," /></td>
<td><img class='tex' src="../../../math/0/d/9/0d9ab211a3b290d93adeb614ca1dcf87.png" alt="p_0 + p_1 x + \cdots + p_n x^n" /></td>
</tr>
<tr>
<td></td>
<td></td>
<td><img class='tex' src="../../../math/1/e/3/1e354350e9e1c0ddab90081a613bbc8d.png" alt="\, + p_1x'\varepsilon + 2p_2xx'\varepsilon + \cdots + np_n x^{n-1} x'\varepsilon" /></td>
</tr>
<tr>
<td></td>
<td><img class='tex' src="../../../math/4/4/8/4488ba5f7e82e2d8c136b559d95283d5.png" alt="=\," /></td>
<td><img class='tex' src="../../../math/a/d/e/adeefbf428e11361d2a8d509bf79407a.png" alt="P(x) + P'(x)x'\varepsilon" /></td>
</tr>
</table>
<p><span class="texhtml"><i>x</i>'</span> can be chosen arbitrarily for now, it will be denoted a <i>seed</i> later.</p>
<p>The new arithmetic consists of <a href="../../../o/r/d/Ordered_pair.html" title="Ordered pair">ordered pairs</a>, elements written <img class='tex' src="../../../math/0/e/d/0edbb4f74fc0e8f8c0b8ce0e3b92a5d7.png" alt="\langle x, x' \rangle" />, with ordinary arithmetics on the first component, and first order differentiation arithmetic on the second component, as can be derived as above. Extending the above results on polynomials to <a href="../../../a/n/a/Analytic_functions.html" title="Analytic functions">analytic functions</a> we obtain a list of the basic arithmetic and some standard functions for the new arithmetic:</p>
<dl>
<dd><img class='tex' src="../../../math/b/1/c/b1ccb753610960e6a2681258889ebb91.png" alt="\langle u,u'\rangle +\langle v,v'\rangle = \langle u+v, u'+v' \rangle" /></dd>
<dd><img class='tex' src="../../../math/a/c/d/acd43128d07073ae56e178161dd261fd.png" alt="\langle u,u'\rangle -\langle v,v'\rangle = \langle u-v, u'-v' \rangle" /></dd>
<dd><img class='tex' src="../../../math/9/f/5/9f5c83b9613c71ed4f2bddd1fc87a53f.png" alt="\langle u,u'\rangle *\langle v,v'\rangle = \langle u v, u'v+uv' \rangle" /></dd>
<dd><img class='tex' src="../../../math/c/a/1/ca1d7b7f111c5f6a6b8aed75fc3356c7.png" alt="\langle u,u'\rangle /\langle v,v'\rangle = \left\langle \frac{u}{v}, \frac{u'v-uv'}{v^2} \right\rangle \quad ( v\ne 0)" /></dd>
<dd><img class='tex' src="../../../math/1/d/b/1db09d7d29762f81ac75984dd23963e5.png" alt="\sin\langle u,u'\rangle = \langle \sin(u) , u' \cos(u) \rangle" /></dd>
<dd><img class='tex' src="../../../math/c/a/2/ca29bf41f7f9b735da5ca82588f821c2.png" alt="\cos\langle u,u'\rangle = \langle \cos(u) , -u' \sin(u) \rangle" /></dd>
<dd><img class='tex' src="../../../math/3/6/9/369b11ec3ab2df72bfff26e4c540c723.png" alt="\exp\langle u,u'\rangle = \langle \exp u , u' \exp u \rangle" /></dd>
<dd><img class='tex' src="../../../math/6/c/6/6c60bfda77fa8a2c2b6aee3c34b00420.png" alt="\log\langle u,u'\rangle = \langle \log(u) , u'/u \rangle \quad (u&gt;0)" /></dd>
<dd><img class='tex' src="../../../math/e/a/e/eae54c280be12d0e2ba904395184af65.png" alt="\langle u,u'\rangle^k = \langle u^k , k u^{k-1} u' \rangle \quad (u \ne 0)" /></dd>
<dd><img class='tex' src="../../../math/5/b/4/5b4abc48961736791551681fc0d1a60b.png" alt="\left| \langle u,u'\rangle \right| = \langle \left| u \right| , u' \mbox{sign} u \rangle \quad (u \ne 0)" /></dd>
</dl>
<p>and in general for the primitive function <span class="texhtml"><i>g</i></span>,</p>
<dl>
<dd><img class='tex' src="../../../math/9/5/7/9577dc71d7d526a7b752905495b62b79.png" alt="g(\langle u,u' \rangle , \langle v,v' \rangle ) = \langle g(u,v) , g^{(1)}(u,v) u' + g^{(2)}(u,v) v' \rangle" /></dd>
</dl>
<p>where <span class="texhtml"><i>g</i><sup>(1)</sup></span> and <span class="texhtml"><i>g</i><sup>(2)</sup></span> are the derivatives of <span class="texhtml"><i>g</i></span> with respect to its first and second arguments, respectively.</p>
<p>Also, when a binary basic arithmetic operation is applied to mixed arguments, say the ordered pair <img class='tex' src="../../../math/2/4/2/24218997211f683a515ba7476b15e605.png" alt="\langle u,u' \rangle" /> and the real number <span class="texhtml"><i>c</i></span>, the real number is first lifted to <img class='tex' src="../../../math/c/c/9/cc97a39c75aa17b6b46d0cc292f3c381.png" alt="\langle c,0 \rangle" />. The derivative of a function <img class='tex' src="../../../math/f/7/5/f75d27a8b3068ca25b9548bbfe7d6532.png" alt="f&#160;: \mathbb{R}\rightarrow\mathbb{R}" /> at the point <span class="texhtml"><i>x</i><sub>0</sub></span> is now found by calculating <img class='tex' src="../../../math/b/c/9/bc98970af283662a2f58a29eda7e97e8.png" alt="f(\langle x_0, 1 \rangle)" /> using the above arithmetic, which gives <img class='tex' src="../../../math/b/4/a/b4a856f6ba7e92b6b79c382249f5e939.png" alt="\langle f ( x_0 ) , f' ( x_0 ) \rangle" /> as the result.</p>
<p><a name="Vector_arguments_and_functions" id="Vector_arguments_and_functions"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Vector arguments and functions">edit</a>]</span> <span class="mw-headline">Vector arguments and functions</span></h3>
<p>Multivariate functions can be handled with the same efficiency and mechanisms as univariate functions by adopting a directional derivative operator, which finds the directional derivative <span class="texhtml"><i>y</i>'</span> in <img class='tex' src="../../../math/d/e/a/dea8d7ab7e42ddd9d6421d796b7da56a.png" alt="\mathbb{R}^m" /> of <img class='tex' src="../../../math/3/a/f/3af1c55bea3f7aa050dc0e10b3761cb7.png" alt="f:\mathbb{R}^n\rightarrow\mathbb{R}^m" /> at <span class="texhtml"><i>x</i></span> in <img class='tex' src="../../../math/3/0/c/30c28f76ef7517dbd19df4d4c683dbe6.png" alt="\mathbb{R}^n" /> in the direction <span class="texhtml"><i>x</i>'</span> in <img class='tex' src="../../../math/3/0/c/30c28f76ef7517dbd19df4d4c683dbe6.png" alt="\mathbb{R}^n" /> by calculating <img class='tex' src="../../../math/4/c/b/4cb2bb1ad4535e3f6b6e5fcf3fe94e57.png" alt="(\langle y_1,y'_1\rangle, \ldots, \langle y_m,y'_m\rangle) = f(\langle x_1,x'_1\rangle, \ldots, \langle x_n,x'_n\rangle)" /> using the same arithmetic as above.</p>
<p><a name="Higher_order_differentials" id="Higher_order_differentials"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Higher order differentials">edit</a>]</span> <span class="mw-headline">Higher order differentials</span></h3>
<p>The above arithmetic can be generalized, in the natural way, to second order and higher derivatives. However, the arithmetic rules quickly grow very complicated, complexity will be quadratic in the highest derivative degree Instead, truncated <a href="../../../t/a/y/Taylor_series.html" title="Taylor series">Taylor series</a> arithmetic is used. This is possible because the Taylor summands in a Taylor series of a function are products of known coefficients and derivatives of the function. Computations of <a href="../../../h/e/s/Hessian.html" title="Hessian">Hessians</a> using AD has proven useful in some optimization contexts.</p>
<p><a name="The_chain_rule.2C_forward_and_reverse_accumulation" id="The_chain_rule.2C_forward_and_reverse_accumulation"></a></p>
<h2><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: The chain rule, forward and reverse accumulation">edit</a>]</span> <span class="mw-headline">The chain rule, forward and reverse accumulation</span></h2>
<p>Fundamental to AD is the decomposition of differentials provided by the <a href="../../../c/h/a/Chain_rule.html" title="Chain rule">chain rule</a>. For the simple composition <span class="texhtml"><i>f</i>(<i>x</i>) = <i>g</i>(<i>h</i>(<i>x</i>))</span> the chain rule gives</p>
<dl>
<dd><img class='tex' src="../../../math/1/2/7/1271516ff73fbfe827d78178707411ff.png" alt="\frac{df}{dx} = \frac{dg}{dh} \frac{dh}{dx}" /></dd>
</dl>
<p>Usually, two distinct modes of AD are presented, <i>forward accumulation</i> (or forward mode) and <i>reverse accumulation</i> (or reverse mode, the use of "backward" is discouraged). Forward accumulation specifies that one traverses the chain rule from right to left, that is first one computes <span class="texhtml"><i>d</i><i>h</i> / <i>d</i><i>x</i></span> and then <span class="texhtml"><i>d</i><i>g</i> / <i>d</i><i>h</i></span>, and reverse accumulation from left to right.</p>
<div class="thumb tright">
<div class="thumbinner" style="width:302px;"><a href="../../../f/o/r/Image%7EForwardAccumulationAutomaticDifferentiation.png_08f5.html" class="internal" title="Figure 2: Example of forward accumulation with computational graph"><img src="../../../upload/thumb/a/a4/ForwardAccumulationAutomaticDifferentiation.png/300px-ForwardAccumulationAutomaticDifferentiation.png" alt="Figure 2: Example of forward accumulation with computational graph" width="300" height="153" longdesc="../../../f/o/r/Image%7EForwardAccumulationAutomaticDifferentiation.png_08f5.html" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify" style="float:right"><a href="../../../f/o/r/Image%7EForwardAccumulationAutomaticDifferentiation.png_08f5.html" class="internal" title="Enlarge"><img src="../../../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
Figure 2: Example of forward accumulation with computational graph</div>
</div>
</div>
<p><a name="Forward_accumulation" id="Forward_accumulation"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Forward accumulation">edit</a>]</span> <span class="mw-headline">Forward accumulation</span></h3>
<p>Forward accumulation automatic differentiation is easiest to understand and to implement. The function <span class="texhtml"><i>f</i>(<i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>) = <i>x</i><sub>1</sub><i>x</i><sub>2</sub> + sin(<i>x</i><sub>1</sub>)</span> is by a computer (or the human programmer) interpreted as the sequence of elementary operations on the work variables <span class="texhtml"><i>w</i><sub><i>i</i></sub></span>, and an AD tool for forward accumulation adds the corresponding operations on the second component of the augmented arithmetic.</p>
<table class="wikitable">
<tr>
<th>Original code statements</th>
<th>Added statements for derivatives</th>
</tr>
<tr>
<td><span class="texhtml"><i>w</i><sub>1</sub> = <i>x</i><sub>1</sub></span></td>
<td><span class="texhtml"><i>w</i>'<sub>1</sub> = 1</span> (seed)</td>
</tr>
<tr>
<td><span class="texhtml"><i>w</i><sub>2</sub> = <i>x</i><sub>2</sub></span></td>
<td><span class="texhtml"><i>w</i>'<sub>2</sub> = 0</span> (seed)</td>
</tr>
<tr>
<td><span class="texhtml"><i>w</i><sub>3</sub> = <i>w</i><sub>1</sub><i>w</i><sub>2</sub></span></td>
<td><span class="texhtml"><i>w</i>'<sub>3</sub> = <i>w</i>'<sub>1</sub><i>w</i><sub>2</sub> + <i>w</i><sub>1</sub><i>w</i>'<sub>2</sub> = 1<i>x</i><sub>2</sub> + <i>x</i><sub>1</sub>0 = <i>x</i><sub>2</sub></span></td>
</tr>
<tr>
<td><span class="texhtml"><i>w</i><sub>4</sub> = sin(<i>w</i><sub>1</sub>)</span></td>
<td><span class="texhtml"><i>w</i>'<sub>4</sub> = cos(<i>w</i><sub>1</sub>)<i>w</i>'<sub>1</sub> = cos(<i>x</i><sub>1</sub>)1</span></td>
</tr>
<tr>
<td><span class="texhtml"><i>w</i><sub>5</sub> = <i>w</i><sub>3</sub> + <i>w</i><sub>4</sub></span></td>
<td><span class="texhtml"><i>w</i>'<sub>5</sub> = <i>w</i>'<sub>3</sub> + <i>w</i>'<sub>4</sub> = <i>x</i><sub>2</sub> + cos(<i>x</i><sub>1</sub>)</span></td>
</tr>
</table>
<p>The derivative computation for <span class="texhtml"><i>f</i>(<i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>) = <i>x</i><sub>1</sub><i>x</i><sub>2</sub> + sin(<i>x</i><sub>1</sub>)</span> needs to be seeded in order to distuingish between the derivative with respect to <span class="texhtml"><i>x</i><sub>1</sub></span> or <span class="texhtml"><i>x</i><sub>2</sub></span>. The table above seeds the computation with <span class="texhtml"><i>w</i>'<sub>1</sub> = 1</span> and <span class="texhtml"><i>w</i>'<sub>2</sub> = 0</span> and we see that this results in <span class="texhtml"><i>x</i><sub>2</sub> + cos(<i>x</i><sub>1</sub>)</span> which is the derivative with respect to <span class="texhtml"><i>x</i><sub>1</sub></span>. Note that although the table displays the symbolic derivative, in the computer it is always the evaluated (numeric) value that is stored. Figure 2 represents the above statements in a computational graph.</p>
<p>In order to compute the gradient of this example function, that is <img class='tex' src="../../../math/1/8/1/18139cb7e2a35c4f1b0b71515b68b056.png" alt="\partial f/\partial x_1" /> and <img class='tex' src="../../../math/d/4/7/d478317cc295b4373eb3f52e6a4650ca.png" alt="\partial f / \partial x_2" />, two sweeps over the computational graph is needed, first with the seeds <span class="texhtml"><i>w</i>'<sub>1</sub> = 1</span> and <span class="texhtml"><i>w</i>'<sub>2</sub> = 0</span>, then with <span class="texhtml"><i>w</i>'<sub>1</sub> = 0</span> and <span class="texhtml"><i>w</i>'<sub>2</sub> = 1</span>.</p>
<p>The <a href="../../../c/o/m/Computational_complexity_theory.html" title="Computational complexity theory">computational complexity</a> of one sweep of forward accumulation is proportional to the complexity of the original code.</p>
<p>Forward accumulation is superior to reverse accumulation for functions <img class='tex' src="../../../math/1/f/d/1fdd29208e3c1c25dec5d290b095affc.png" alt="f:\mathbb{R} \rightarrow \mathbb{R}^m" /> with <img class='tex' src="../../../math/f/c/8/fc85202ba069637b9bd388bdb7796f50.png" alt="m \gg 1" /> as only one sweep is necessary, compared to <span class="texhtml"><i>m</i></span> sweeps for reverse accumulation.</p>
<div class="thumb tright">
<div class="thumbinner" style="width:302px;"><a href="../../../r/e/v/Image%7EReverseaccumulationAD.png_dcd5.html" class="internal" title="Figure 3: Example of reverse accumulation with computational graph"><img src="../../../upload/thumb/a/a0/ReverseaccumulationAD.png/300px-ReverseaccumulationAD.png" alt="Figure 3: Example of reverse accumulation with computational graph" width="300" height="175" longdesc="../../../r/e/v/Image%7EReverseaccumulationAD.png_dcd5.html" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify" style="float:right"><a href="../../../r/e/v/Image%7EReverseaccumulationAD.png_dcd5.html" class="internal" title="Enlarge"><img src="../../../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
Figure 3: Example of reverse accumulation with computational graph</div>
</div>
</div>
<p><a name="Reverse_accumulation" id="Reverse_accumulation"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Reverse accumulation">edit</a>]</span> <span class="mw-headline">Reverse accumulation</span></h3>
<p>Reverse accumulation traverses the chain rule from left to right, or in the case of the computational graph in Figure 3, from top to bottom. The example function is real-valued, and thus there is only one seed for the derivative computation, and only one sweep of the computational graph is needed in order to calculate the (two-component) gradient. This is only half the work when compared to forward accumulation, but reverse accumulation requires the storage of some of the work variables <span class="texhtml"><i>w</i><sub><i>i</i></sub></span>, which may represent a significant memory issue.</p>
<p>The data flow graph of a computation can be manipulated to calculate the gradient of its original calculation. This is done by adding an adjoint node for each primal node, connected by adjoint edges which parallel the primal edges but flow in the opposite direction. The nodes in the adjoint graph represent multiplication by the derivatives of the functions calculated by the nodes in the primal. For instance, addition in the primal causes fanout in the adjoint; fanout in the primal causes addition in the adjoint; a unary function <span class="texhtml"><i>y</i> = <i>f</i>(<i>x</i>)</span> in the primal causes <span class="texhtml"><i>x</i>' = <i>f</i>'(<i>x</i>)<i>y</i>'</span> in the adjoint; etc.</p>
<p>Reverse accumulation is superior to forward accumulation for functions <img class='tex' src="../../../math/a/8/c/a8c45a07c8d0834e8d13ba819e85e3e3.png" alt="f:\mathbb{R}^n \rightarrow \mathbb{R}" /> with <img class='tex' src="../../../math/d/7/4/d7488b4e7c2d3026124907af5290c720.png" alt="n \gg 1" />.</p>
<p><a href="../../../b/a/c/Backpropagation.html" title="Backpropagation">Backpropagation</a> of errors in multilayer perceptrons, a technique used in machine learning, is a special case of reverse mode AD.</p>
<p><a name="Jacobian_computation" id="Jacobian_computation"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Jacobian computation">edit</a>]</span> <span class="mw-headline">Jacobian computation</span></h3>
<p>The <a href="../../../j/a/c/Jacobian.html" title="Jacobian">Jacobian</a> <span class="texhtml"><i>J</i></span> of <img class='tex' src="../../../math/3/a/f/3af1c55bea3f7aa050dc0e10b3761cb7.png" alt="f:\mathbb{R}^n \rightarrow \mathbb{R}^m" /> is an <img class='tex' src="../../../math/c/4/f/c4f729d02a67ac278165d81c624944ca.png" alt="m \times n" /> matrix. The Jacobian can be computed using <span class="texhtml"><i>n</i></span> sweeps of forward accumulation, of which each sweep can yield a column vector of the Jacobian, or with <span class="texhtml"><i>m</i></span> sweeps of reverse accumulation, of which each sweep can yield a row vector of the Jacobian.</p>
<p><a name="Beyond_forward_and_reverse_accumulation" id="Beyond_forward_and_reverse_accumulation"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Beyond forward and reverse accumulation">edit</a>]</span> <span class="mw-headline">Beyond forward and reverse accumulation</span></h3>
<p>Forward and reverse accumulation are just two (extreme) ways of traversing the chain rule. In order to compute a full Jacobian of <img class='tex' src="../../../math/3/a/f/3af1c55bea3f7aa050dc0e10b3761cb7.png" alt="f:\mathbb{R}^n \rightarrow \mathbb{R}^m" />, there is a path somewhere in between which is optimal, however, locating that path is probably an <a href="../../../n/p/-/NP-hard_1fde.html" title="NP-hard">NP-hard</a> problem.</p>
<p><a name="Implementation" id="Implementation"></a></p>
<h2><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Implementation">edit</a>]</span> <span class="mw-headline">Implementation</span></h2>
<p>Forward-mode AD is implemented by a Nonstandard interpretation of the program in which real numbers are replaced by dual numbers, constants are lifted to dual numbers with a zero epsilon coefficient, and the numeric primitives are lifted to operate on dual numbers. This nonstandard interpretation is generally implemented using one of two strategies: <i>source code transformation</i> or <i>operator overloading</i>.</p>
<p><a name="Source_code_transformation" id="Source_code_transformation"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Source code transformation">edit</a>]</span> <span class="mw-headline">Source code transformation</span></h3>
<div class="thumb tright">
<div class="thumbinner" style="width:302px;"><a href="../../../s/o/u/Image%7ESourceTransformationAutomaticDifferentiation.png_bd37.html" class="internal" title="Figure 4: Example of how source code transformation could work"><img src="../../../upload/thumb/8/80/SourceTransformationAutomaticDifferentiation.png/300px-SourceTransformationAutomaticDifferentiation.png" alt="Figure 4: Example of how source code transformation could work" width="300" height="52" longdesc="../../../s/o/u/Image%7ESourceTransformationAutomaticDifferentiation.png_bd37.html" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify" style="float:right"><a href="../../../s/o/u/Image%7ESourceTransformationAutomaticDifferentiation.png_bd37.html" class="internal" title="Enlarge"><img src="../../../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
Figure 4: Example of how source code transformation could work</div>
</div>
</div>
<p>The source code for a function is replaced by an automatically generated source code that includes statements for calculating the derivatives interleaved with the original instructions.</p>
<p>Source code transformation can be implemented for all programming languages, and it is also easier for the compiler to do compile time optimizations. However, the implementation of the AD tool itself is more difficult.</p>
<p>Examples:</p>
<ul>
<li><a href="http://www-fp.mcs.anl.gov/adic/" class="external text" title="http://www-fp.mcs.anl.gov/adic/" rel="nofollow">ADIC</a> (C/C++, forward mode)</li>
<li><a href="http://www-unix.mcs.anl.gov/autodiff/ADIFOR/" class="external text" title="http://www-unix.mcs.anl.gov/autodiff/ADIFOR/" rel="nofollow">ADIFOR</a> (Fortran77)</li>
<li><a href="http://www-unix.mcs.anl.gov/~utke/OpenAD/" class="external text" title="http://www-unix.mcs.anl.gov/~utke/OpenAD/" rel="nofollow">OpenAD</a> (Fortran77, Fortran95, C/C++)</li>
<li><a href="http://tapenade.inria.fr:8080/tapenade/index.jsp" class="external text" title="http://tapenade.inria.fr:8080/tapenade/index.jsp" rel="nofollow">TAPENADE</a> (Fortran77, Fortran95)</li>
</ul>
<p><a name="Operator_overloading" id="Operator_overloading"></a></p>
<h3><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: Operator overloading">edit</a>]</span> <span class="mw-headline">Operator overloading</span></h3>
<div class="thumb tright">
<div class="thumbinner" style="width:302px;"><a href="../../../o/p/e/Image%7EOperatorOverloadingAutomaticDifferentiation.png_afa4.html" class="internal" title="Figure 5: Example of how operator overloading could work"><img src="../../../upload/thumb/a/af/OperatorOverloadingAutomaticDifferentiation.png/300px-OperatorOverloadingAutomaticDifferentiation.png" alt="Figure 5: Example of how operator overloading could work" width="300" height="74" longdesc="../../../o/p/e/Image%7EOperatorOverloadingAutomaticDifferentiation.png_afa4.html" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify" style="float:right"><a href="../../../o/p/e/Image%7EOperatorOverloadingAutomaticDifferentiation.png_afa4.html" class="internal" title="Enlarge"><img src="../../../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
Figure 5: Example of how operator overloading could work</div>
</div>
</div>
<p><a href="../../../o/p/e/Operator_overloading.html" title="Operator overloading">Operator overloading</a> is a possibility for source code written in a language supporting it. Objects for real numbers and elementary mathematical operations must be overloaded to cater for the augmented arithemtic depicted above. This requires no change in the original source code for the function to be differentiated.</p>
<p>Operator overloading for forward accumulation is easy to implement, and also possible for backward accumulation. However, current compilers lag behind in optimizing the code when compared to forward accumulation.</p>
<p>Example:</p>
<ul>
<li><a href="http://www.math.tu-dresden.de/~adol-c/" class="external text" title="http://www.math.tu-dresden.de/~adol-c/" rel="nofollow">ADOL-C</a> (C/C++)</li>
</ul>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ul>
<li>Andreas Griewank (2000), <i>Evaluating Derivatives: Principles and Techniques of Algorithmic Differentiation</i>, SIAM, <a href="../../../b/o/o/Special%7EBooksources_ed7b.html" class="internal">ISBN 0-89871-451-6</a></li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="../../../a/u/t/Automatic_differentiation.html" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.autodiff.org/" class="external text" title="http://www.autodiff.org/" rel="nofollow">www.autodiff.org</a>, An "entry site to everything you want to know about automatic differentiation"</li>
<li><a href="http://karminghenry.sinaman.com/" class="external text" title="http://karminghenry.sinaman.com/" rel="nofollow">Automatic Differentiation of Parallel OpenMP Programs</a></li>
</ul>

<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../a/u/t/Automatic_differentiation.html">http://en.wikipedia.org../../../a/u/t/Automatic_differentiation.html</a>"</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="../../../d/i/f/Category%7EDifferential_calculus_ed61.html" title="Category:Differential calculus">Differential calculus</a></span> | <span dir='ltr'><a href="../../../c/o/m/Category%7EComputer_algebra_f308.html" title="Category:Computer algebra">Computer algebra</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="../../../a/u/t/Automatic_differentiation.html">Article</a></li><li id="ca-talk"
	       	       ><a href="../../../a/u/t/Talk%7EAutomatic_differentiation_a078.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/Automatic_differentiation">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	<div id="p-lang" class="portlet">
	  <h5>In other languages</h5>
	  <div class="pBody">
	    <ul>
	      	      <li>
	      <a href="../../../../de/a/u/t/Automatisches_Differenzieren_677b.html">Deutsch</a>
	      </li>
	      	    </ul>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 18:36, 6 April 2007 by Wikipedia user <a href="../../../r/j/w/User%7ERjwilmsi_027f.html" title="User:Rjwilmsi">Rjwilmsi</a>. Based on work by Wikipedia user(s) <a href="../../../b/e/r/User%7EBerland_c109.html" title="User:Berland">Berland</a>, <a href="../../../b/a/r/User%7EBarak_2a23.html" title="User:Barak">Barak</a>, <a href="../../../l/y/o/User%7ELyonsam_adc9.html" title="User:Lyonsam">Lyonsam</a>, Tylerbh, <a href="../../../r/i/c/User%7ERich_Farmbrough_7642.html" title="User:Rich Farmbrough">Rich Farmbrough</a>, <a href="../../../j/i/t/User%7EJitse_Niesen_c0c4.html" title="User:Jitse Niesen">Jitse Niesen</a>, <a href="../../../i/c/a/User%7EIcairns_bb52.html" title="User:Icairns">Icairns</a>, <a href="../../../m/a/t/User%7EMathbot_604f.html" title="User:Mathbot">Mathbot</a>, <a href="../../../o/l/e/User%7EOleg_Alexandrov_8bb5.html" title="User:Oleg Alexandrov">Oleg Alexandrov</a>, <a href="../../../u/t/h/User%7EUtherSRG_e5aa.html" title="User:UtherSRG">UtherSRG</a>, Wikipedia,Jesus,Hitler, <a href="../../../p/l/a/User%7EPlasma_8397.html" title="User:Plasma">Plasma</a>, <a href="../../../s/a/m/User%7ESam_Hocevar_dccf.html" title="User:Sam Hocevar">Sam Hocevar</a>, <a href="../../../c/h/a/User%7ECharles_Matthews_cceb.html" title="User:Charles Matthews">Charles Matthews</a>, DanielJanzon and <a href="../../../c/l/u/User%7ECluster_0603.html" title="User:Cluster">Cluster</a> and Anonymous user(s) of Wikipedia.</li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
