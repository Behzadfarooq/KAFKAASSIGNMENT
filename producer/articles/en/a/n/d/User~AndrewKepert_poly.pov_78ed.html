<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    		<meta name="keywords" content="User:AndrewKepert/poly.pov,Poly.pov,Hebesphenomegacorona,Snub disphenoid,Snub square antiprism,Sphenocorona,Sphenomegacorona,Johnson solid,Cyp" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (English)" />
		<link rel="copyright" href="../../../COPYING.html" />
    <title>User:AndrewKepert/poly.pov - Wikipedia, the free encyclopedia</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../skins/htmldump/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/md5.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/utf8.js"></script>
    <script type="text/javascript" src="../../../skins/htmldump/lookup.js"></script>
    <script type="text/javascript" src="../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../raw/MediaWiki%7ECommon.css";
@import "../../../raw/MediaWiki%7EMonobook.css";
@import "../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="ns-2">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">User:AndrewKepert/poly.pov</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
	    <div id="contentSub"><span class="subpages">&lt; <a href="../../../a/n/d/User%7EAndrewKepert_6eb5.html" title="User:AndrewKepert">User:AndrewKepert</a></span></div>
	    	    <div class="usermessage">You have <a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">new messages</a> (<a href="../../../1/2/7/User_talk%7E127.0.0.1.html" title="User talk:127.0.0.1">last change</a>).</div>	    <!-- start content -->
	    <p>This is my modification of <a href="../../../c/y/p/User%7ECyp_f138.html" title="User:Cyp">user:Cyp</a>'s <a href="../../../p/o/l/Image%7EPoly.pov_936d.html" title="Image:Poly.pov">image:Poly.pov</a> povray macros. I don't know (yet) how to upload a .pov file - wikipedia complains that it is not a known image type. Oh well. It also screws up with html encoding. (too bad!)</p>
<p><a name="Progress" id="Progress"></a></p>
<h2><span class="editsection">[<a href="../../../a/n/d/User%7EAndrewKepert_poly.pov_78ed.html" title="Edit section: Progress">edit</a>]</span> <span class="mw-headline">Progress</span></h2>
<p>Updated 01:37, 5 Nov 2004 (UTC) to include more cut+paste polyhedra and a new optimisation procedure to get the "sporadic" ones -- currently only the <a href="../../../s/n/u/Snub_disphenoid.html" title="Snub disphenoid">Snub_disphenoid</a>.</p>
<p>Updated 00:14, 8 Nov 2004 (UTC)</p>
<ul>
<li>Further sporadic Johnson solids (See <a href="../../../j/o/h/Talk%7EJohnson_solid_f17e.html" title="Talk:Johnson solid">Talk:Johnson solid</a>) <a href="../../../s/n/u/Snub_square_antiprism.html" title="Snub square antiprism">J85</a>, <a href="../../../s/p/h/Sphenocorona.html" title="Sphenocorona">J86</a>, <a href="../../../s/p/h/Sphenomegacorona.html" title="Sphenomegacorona">J88</a>, <a href="../../../h/e/b/Hebesphenomegacorona.html" title="Hebesphenomegacorona">J89</a></li>
<li>A rudimentary automatic-framing solution to minimise excess whitespace. This means a whole stack of poorly-framed images will need redoing.</li>
</ul>
<p><a name="Todo" id="Todo"></a></p>
<h2><span class="editsection">[<a href="../../../a/n/d/User%7EAndrewKepert_poly.pov_78ed.html" title="Edit section: Todo">edit</a>]</span> <span class="mw-headline">Todo</span></h2>
<ul>
<li>Modify augment(n,a,b,c) to work with n=4,5 (square, pentagonal pyramid) n=6,8,10 (cupolae)</li>
<li>Finish sporadics using optimise()</li>
<li>Finish set of cuboctahedron modifications (very similar to work already done)</li>
<li>Many not very interesting polyhedra from putting cupolae on various faces of archimedean solids.</li>
</ul>
<pre>
//Picture   ***  Use flashiness=1 !!! ***
//
//   +w1024 +h1024 +a0.3 +am2
//   +w512 +h512 +a0.3 +am2
//
//Movie   ***  Use flashiness=0.25 !!! ***
//
//   +kc +kff120 +w256 +h256 +a0.3 +am2
//   +kc +kff60 +w256 +h256 +a0.3 +am2
//"Fast" preview
//   +w128 +h128
#declare notwireframe=1;
#declare withreflection=0;
#declare flashiness=0.25; //Still pictures use 1, animated should probably be about 0.25.

#macro This_shape_will_be_drawn()
   //PLATONIC SOLIDS ***********
  //tetrahedron() #declare rotation=seed(1889/*1894*/);
  //hexahedron() #declare rotation=seed(7122);
  //octahedron() #declare rotation=seed(4193);
  //dodecahedron() #declare rotation=seed(4412);
  //icosahedron() #declare rotation=seed(7719);


  //weirdahedron() #declare rotation=seed(7412);


   //ARCHIMEDIAN SOLIDS ***********
  //cuboctahedron() #declare rotation=seed(1941);
  //icosidodecahedron() #declare rotation=seed(2241);

  //truncatedtetrahedron(0) #declare rotation=seed(8717);
    //truncatedhexahedron(0) #declare rotation=seed(1345);
  //truncatedoctahedron() #declare rotation=seed(7235);
  //truncateddodecahedron(0) #declare rotation=seed(9374);
  //truncatedicosahedron() #declare rotation=seed(1666);

  //rhombicuboctahedron() #declare rotation=seed(6124);
  //truncatedcuboctahedron() #declare rotation=seed(1156);
  //rhombicosidodecahedron() #declare rotation=seed(8266);
  //truncatedicosidodecahedron() #declare rotation=seed(1422);

  //snubhexahedron(-1) #declare rotation=seed(7152);
  //snubhexahedron(1) #declare rotation=seed(1477);
  //snubdodecahedron(-1) #declare rotation=seed(5111);
  //snubdodecahedron(1) #declare rotation=seed(8154);


   //CATALAN SOLIDS ***********
  //rhombicdodecahedron() #declare rotation=seed(7154);
  //rhombictriacontahedron() #declare rotation=seed(1237);

  //triakistetrahedron() #declare rotation=seed(7735);
  //triakisoctahedron() #declare rotation=seed(5354);
  //tetrakishexahedron() #declare rotation=seed(1788);
  //triakisicosahedron() #declare rotation=seed(1044);
  //pentakisdodecahedron() #declare rotation=seed(6100);

  //deltoidalicositetrahedron() #declare rotation=seed(5643);
  //disdyakisdodecahedron() #declare rotation=seed(1440);
  //deltoidalhexecontahedron() #declare rotation=seed(1026);
  //disdyakistriacontahedron() #declare rotation=seed(1556);

  //pentagonalicositetrahedron(-1) #declare rotation=seed(7771);
  //pentagonalicositetrahedron(1) #declare rotation=seed(3470);
  //pentagonalhexecontahedron(-1) #declare rotation=seed(1046);
  //pentagonalhexecontahedron(1) #declare rotation=seed(1096);

   //PRISMS, ANTIPRISMS, ETC... ***********
  //rprism(5) #declare rotation=seed(6620);
  //antiprism(5) #declare rotation=seed(6620);
  //bipyramid(5) #declare rotation=seed(6620);
  //trapezohedron(17) #declare rotation=seed(6620);

    // JOHNSON SOLIDS  (AGK)
    //square_pyramid() #declare rotation=seed(84); //  J1
    //pentagonal_pyramid() #declare rotation=seed(11); //  J2
    //triangular_cupola() #declare rotation=seed(11);  //  J3
    //square_cupola() #declare rotation=seed(19);  //  J4
    //pentagonal_cupola() #declare rotation=seed(19);  //  J5
    //pentagonal_rotunda() #declare rotation=seed(4);  //  J6
    //elongated_pyramid(3) #declare rotation=seed(444);// J7
    //elongated_pyramid(4) #declare rotation=seed(444);// J8
    //elongated_pyramid(5) #declare rotation=seed(444);// J9
    //gyroelongated_square_pyramid() #declare rotation=seed(6621); //  J10
    //gyroelongated_pentagonal_pyramid() #declare rotation=seed(6621); //  J11
    //dipyramid(3) #declare rotation=seed(654);// J12
    //dipyramid(5) #declare rotation=seed(654);// J13
    //elongated_dipyramid(3) #declare rotation=seed(654);// J14
    //elongated_dipyramid(4) #declare rotation=seed(654);// J15
    //elongated_dipyramid(5) #declare rotation=seed(654);// J16
    //gyroelongated_square_dipyramid() #declare rotation=seed(6621);   //  J17
    //elongated_triangular_cupola() #declare rotation=seed(112358);    //J18
    //elongated_square_cupola() #declare rotation=seed(333);   //  J19
    //elongated_pentagonal_cupola()  #declare rotation=seed(333);  //J20
    //elongated_pentagonal_rotunda() #declare rotation=seed(4);    //  J21
    //gyroelongated_triangular_cupola() #declare rotation=seed(112358);        //J22
    //gyroelongated_square_cupola() #declare rotation=seed(333);   //  J23
    //gyroelongated_pentagonal_cupola()  #declare rotation=seed(333);  //J24
    //gyroelongated_pentagonal_rotunda() #declare rotation=seed(4);    //  J25
    //gyrobifastigium() #declare rotation=seed(112358);    //  J26
    //triangular_orthobicupola() #declare rotation=seed(112358);   //J27
    //square_orthobicupola() #declare rotation=seed(333);  //  J28
    //square_gyrobicupola() #declare rotation=seed(333);   //  J29
    //pentagonal_orthobicupola() #declare rotation=seed(333);  //J30
    //pentagonal_gyrobicupola() #declare rotation=seed(333);   //J31
    //pentagonal_orthocupolarotunda() #declare rotation=seed(4);   //J32
    //pentagonal_gyrocupolarotunda() #declare rotation=seed(4);    //J33
    //pentagonal_orthobirotunda() #declare rotation=seed(4);   //  J34
    //elongated_triangular_orthobicupola() #declare rotation=seed(112358); //J35
    //elongated_triangular_gyrobicupola() #declare rotation=seed(112358);  //J36
    //elongated_square_gyrobicupola() #declare rotation=seed(333); //  J37
    //elongated_pentagonal_orthobicupola() #declare rotation=seed(333);    //J38
    //elongated_pentagonal_gyrobicupola() #declare rotation=seed(333); //J39
    //icosidodecahedron_mod(40) #declare rotation=seed(4); //J40: elongated_pentagonal_orthocupolarotunda
    //icosidodecahedron_mod(41) #declare rotation=seed(4); //J41: elongated_pentagonal_gyrocupolarotunda
    //elongated_pentagonal_orthobirotunda() #declare rotation=seed(4); //  J42
    //elongated_pentagonal_gyrobirotunda() #declare rotation=seed(4);  //  J43
    //gyroelongated_triangular_bicupola() #declare rotation=seed(112358);  //J44
    //gyroelongated_square_bicupola() #declare rotation=seed(333); //  J45
    //gyroelongated_pentagonal_bicupola() #declare rotation=seed(333); //J46
    //icosidodecahedron_mod(47) #declare rotation=seed(4); //J47: gyroelongated_pentagonal_cupolarotunda
    //gyroelongated_pentagonal_birotunda() #declare rotation=seed(4);  //  J48
    //augmented_triangular_prism() #declare rotation=seed(88);// J49
    //biaugmented_triangular_prism() #declare rotation=seed(88);// J50
    //triaugmented_triangular_prism() #declare rotation=seed(88);// J51
    //augmented_pentagonal_prism() #declare rotation=seed(5555);// J52
    //biaugmented_pentagonal_prism() #declare rotation=seed(5555);// J53
    //augmented_hexagonal_prism() #declare rotation=seed(5555);// J54
    //parabiaugmented_hexagonal_prism() #declare rotation=seed(5555);// J55
    //metabiaugmented_hexagonal_prism() #declare rotation=seed(5555);// J56
    //triaugmented_hexagonal_prism() #declare rotation=seed(5555);// J56
    //augmented_dodecahedron() #declare rotation=seed(4412);   //  J58
    //parabiaugmented_dodecahedron() #declare rotation=seed(4412); //  J59
    ////metabiaugmented_dodecahedron() #declare rotation=seed(4412);   //  J60
    //triaugmented_dodecahedron() #declare rotation=seed(4412);    //  J61
    //metabidiminished_icosahedron() #declare rotation=seed(6621); //  J62
    //tridiminished_icosahedron() #declare rotation=seed(6621);    //  J63
    //augmented_tridiminished_icosahedron() #declare rotation=seed(6621);  //  J64

    //truncatedtetrahedron(1) #declare rotation=seed(13);  // J65 augmented_truncated_tetrahedron.png
    //truncatedhexahedron(1) #declare rotation=seed(1345); // J66 augmented_truncated_cube.png
    //truncatedhexahedron(2) #declare rotation=seed(1345); // J67 biaugmented_truncated_cube.png
    //truncateddodecahedron(1) #declare rotation=seed(19); // J68 augmented_truncated_dodecahedron.png
    //truncateddodecahedron(-2) #declare rotation=seed(19);    // J69 parabiaugmented_truncated_dodecahedron.png
    //truncateddodecahedron(2) #declare rotation=seed(19); // J70 metabiaugmented_truncated_dodecahedron.png
    truncateddodecahedron(3) #declare rotation=seed(19);   // J71 triaugmented_truncated_dodecahedron.png

    //mogrified_rhombicosidodecahedron("G...") #declare rotation=seed(19); //  J72 gyrate_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("G..G") #declare rotation=seed(19); //  J73 parabigyrate_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("GG..") #declare rotation=seed(19); //  J74 metabigyrate_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("GGG.") #declare rotation=seed(19); //  J75 trigyrate_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("D...") #declare rotation=seed(19); //  J76 diminished_rhombicosidodecahedron.png   
    //mogrified_rhombicosidodecahedron("D..G") #declare rotation=seed(19); //  J77 paragyrate_diminished_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("DG..") #declare rotation=seed(19); //  J78 metagyrate_diminished_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("GDG.") #declare rotation=seed(19); //  J79 bigyrate_diminished_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("D..D") #declare rotation=seed(19); //  J80 parabidiminished_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("DD..") #declare rotation=seed(19); //  J81 metabidiminished_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("GDD.") #declare rotation=seed(19); //  J82 gyrate_bidiminished_rhombicosidodecahedron.png
    //mogrified_rhombicosidodecahedron("DDD.") #declare rotation=seed(19); //  J83 tridiminished_rhombicosidodecahedron.png
                //gyrate_rhombicosidodecahedron() #declare rotation=seed(19);  //  J72
                //trigyrate_rhombicosidodecahedron() #declare rotation=seed(19);   //J75
                //diminished_rhombicosidodecahedron() #declare rotation=seed(19);  //  J76
                //parabidiminished_rhombicosidodecahedron() #declare rotation=seed(19);    //J80
                //metabidiminished_rhombicosidodecahedron() #declare rotation=seed(19);    //J81
                //tridiminished_rhombicosidodecahedron() #declare rotation=seed(19);   //  J83
    //snub_disphenoid() #declare rotation=seed(142);   //  J84
    //snub_square_antiprism() #declare rotation=seed(418); //  J85
    //sphenocorona() #declare rotation=seed(11);   //  J86
    //augmented_sphenocorona() #declare rotation=seed(11); //  J87
    //sphenomegacorona() #declare rotation=seed(11);   //  J88
    //hebesphenomegacorona() #declare rotation=seed(11);   //  J89
    //disphenocingulum()  #declare rotation=seed(11);  //  J90
    //bilunabirotunda()  #declare rotation=seed(10); // J91
    //triangular_hebesphenorotunda()  #declare rotation=seed(855); // J92
#end


#declare tau=(1+sqrt(5))/2;
#declare sq2=sqrt(2);
#declare sq297=sqrt(297);
#declare xi=(pow(sq297+17,1/3)-pow(sq297-17,1/3)-1)/3;
#declare sqweird=sqrt(tau-5/27);
#declare ouch=pow((tau+sqweird)/2,1/3)+pow((tau-sqweird)/2,1/3);
#declare alfa=ouch-1/ouch;
#declare veta=(ouch+tau+1/ouch)*tau;

#macro tetrahedron()
  addpointsevensgn(&lt;1,1,1&gt;)
  autoface()
#end

#macro hexahedron()
  addpointssgn(&lt;1,1,1&gt;,&lt;1,1,1&gt;)
  autoface()
#end

#macro octahedron()
  addevenpermssgn(&lt;1,0,0&gt;,&lt;1,0,0&gt;)
  autoface()
#end

#macro dodecahedron()
  addpointssgn(&lt;1,1,1&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;0,1/tau,tau&gt;,&lt;0,1,1&gt;)
  autoface()
#end

#macro icosahedron()
  addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;)
  autoface()
#end


#macro weirdahedron()
  addpermssgn(&lt;1,2,3&gt;,&lt;1,1,1&gt;)
  autoface()
#end


#macro cuboctahedron()
  addevenpermssgn(&lt;0,1,1&gt;,&lt;0,1,1&gt;)
  autoface()
#end

#macro icosidodecahedron()
  addevenpermssgn(&lt;0,0,2*tau&gt;,&lt;0,0,1&gt;)
  addevenpermssgn(&lt;1,tau,1+tau&gt;,&lt;1,1,1&gt;)
  autoface()
#end


#macro truncatedtetrahedron(augmentation)
  addevenpermsevensgn(&lt;1,1,3&gt;)
  #if (augmentation)
// augment(6,points[3],points[0],points[1])
    augment(6,points[0],points[1],points[4])
  #end
  autoface()
#end

#macro truncatedhexahedron(augmentation)
  addevenpermssgn(&lt;sq2-1,1,1&gt;,&lt;1,1,1&gt;)
  #switch (augmentation)
    #case(2) augment(8,points[7],points[23],points[22])
    #case(1) augment(8,points[16],points[0],points[1])
  #end
  autoface()
#end

#macro truncatedoctahedron()
  addpermssgn(&lt;0,1,2&gt;,&lt;0,1,1&gt;)
  autoface()
#end

#macro truncateddodecahedron(augmentation)
    addevenpermssgn(&lt;0,1/tau,2+tau&gt;,&lt;0,1,1&gt;)
    addevenpermssgn(&lt;1/tau,tau,2*tau&gt;,&lt;1,1,1&gt;)
    addevenpermssgn(&lt;tau,2,1+tau&gt;,&lt;1,1,1&gt;)
    #if (augmentation)
        augment(10,points[50],points[58],points[34])   // towards (tau,-1,0) -- common to all
        #switch (augmentation)
            #case(3) augment(10,points[54],points[38],points[14])  // towards (-1,0,tau) -- on tri
            #case(2) augment(10,points[40],points[48],points[24])  // towards (0,phi,-1) -- on metadi and tri
            #break
            #case(-2) augment(10,points[32],points[10],points[9])  // towards (-tau,1,0) -- on paradi
        #end
    #end
    autoface()
#end

#macro truncatedicosahedron()
  addevenpermssgn(&lt;0,1,3*tau&gt;,&lt;0,1,1&gt;)
  addevenpermssgn(&lt;2,1+2*tau,tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;1,2+tau,2*tau&gt;,&lt;1,1,1&gt;)
  autoface()
#end


#macro rhombicuboctahedron()
  addevenpermssgn(&lt;1+sq2,1,1&gt;,&lt;1,1,1&gt;)
  autoface()
#end

#macro truncatedcuboctahedron()
  addpermssgn(&lt;1,1+sq2,1+sq2*2&gt;,&lt;1,1,1&gt;)
  autoface()
#end

#macro rhombicosidodecahedron()
  addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
  autoface()
#end

#macro truncatedicosidodecahedron()
  addevenpermssgn(&lt;1/tau,1/tau,3+tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;2/tau,tau,1+2*tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;1/tau,1+tau,3*tau-1&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;2*tau-1,2,2+tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;tau,3,2*tau&gt;,&lt;1,1,1&gt;)
  autoface()
#end


#macro snubhexahedron(s)
  addpermsaltsgn(&lt;1,1/xi,xi&gt;*s)
  autoface()
#end

#macro snubdodecahedron(s)
  addevenpermsevensgn(&lt;2*alfa,2,2*veta&gt;*s)
  addevenpermsevensgn(&lt;alfa+veta/tau+tau,-alfa*tau+veta+1/tau,alfa/tau+veta*tau-1&gt;*s)
  addevenpermsevensgn(&lt;-alfa/tau+veta*tau+1,-alfa+veta/tau-tau,alfa*tau+veta-1/tau&gt;*s)
  addevenpermsevensgn(&lt;-alfa/tau+veta*tau-1,alfa-veta/tau-tau,alfa*tau+veta+1/tau&gt;*s)
  addevenpermsevensgn(&lt;alfa+veta/tau-tau,alfa*tau-veta+1/tau,alfa/tau+veta*tau+1&gt;*s)
  autoface()
#end

#macro rhombicdodecahedron()
  cuboctahedron() dual()
#end

#macro rhombictriacontahedron()
  icosidodecahedron() dual()
#end

#macro triakistetrahedron()
  truncatedtetrahedron(0) dual()
#end

#macro triakisoctahedron()
  truncatedhexahedron(0) dual()
#end

#macro tetrakishexahedron()
  truncatedoctahedron() dual()
#end

#macro triakisicosahedron()
  truncateddodecahedron(0) dual()
#end

#macro pentakisdodecahedron()
  truncatedicosahedron() dual()
#end

#macro deltoidalicositetrahedron()
  rhombicuboctahedron() dual()
#end

#macro disdyakisdodecahedron()
  truncatedcuboctahedron() dual()
#end

#macro deltoidalhexecontahedron()
  rhombicosidodecahedron() dual()
#end

#macro disdyakistriacontahedron()
  truncatedicosidodecahedron() dual()
#end

#macro pentagonalicositetrahedron(s)
  snubhexahedron(s) dual()
#end

#macro pentagonalhexecontahedron(s)
  snubdodecahedron(s) dual()
#end

//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; changed AGK  [20041101]
#macro polygon_vtx(n)
    #local i=0;
    #while (i&lt;n-.5)
        addpoint(&lt;cos(i*2*pi/n),sin(i*2*pi/n),0&gt;)
        #local i=i+1;
    #end
#end
#macro rprism_vtx(n)
  #local a=sqrt((1-cos(2*pi/n))/2);
  #local b=0; #while(b&lt;n-.5)
    addpointssgn(&lt;sin(2*pi*b/n),cos(2*pi*b/n),a&gt;,&lt;0,0,1&gt;)
  #local b=b+1; #end
#end
#macro antiprism_vtx(n)
  #local a=sqrt((cos(pi/n)-cos(2*pi/n))/2);
  #local b=0; #while(b&lt;2*n-.5)
    addpoint(&lt;sin(pi*b/n),cos(pi*b/n),a&gt;)
  #local a=-a; #local b=b+1; #end
#end
#macro rprism(n)
  rprism_vtx(n) autoface()
#end
#macro antiprism(n)
  antiprism_vtx(n)
  autoface()
#end
//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; changed AGK  [20041101]

#macro bipyramid(n)
  rprism(n) dual()
#end

#macro trapezohedron(n)
  antiprism(n) dual()
#end

//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; added AGK  [20041101]
#macro augment(n,va,vb,vc) // on an n-face with 3 adjacent vtxs, add a pyramid or a cupola
    #local veci=va-vb; #local vecj=vc-vb;  #local veck=vlength(vc-vb)*vnormalize(vcross(vc-vb,va-vb));
    #switch(n)
    #case (3) addpoint( (va+vb+vc)/3 + sqrt(2/3)*veck ) #break
    #case (4) addpoint( (va+vc)/2 + sqrt(1/2)*veck ) #break
    #case (5) addpoint( vb+(2+tau)/5*(veci+vecj) + sqrt((3-tau)/5)*veck ) #break
    #case (6)
        addpoint( vb+1/3*veci + 2/3*vecj + sqrt(2/3)*veck )
        addpoint( vb+4/3*veci + 2/3*vecj + sqrt(2/3)*veck )
        addpoint( vb+4/3*veci + 5/3*vecj + sqrt(2/3)*veck )
        #break
    #case (8)
        addpoint( vb + sqrt(1/2)*veci + vecj + sqrt(1/2)*veck )
        addpoint( vb + (1+sqrt(1/2))*veci + vecj + sqrt(1/2)*veck )
        addpoint( vb + (1+sqrt(1/2))*veci + (1+sq2)*vecj + sqrt(1/2)*veck )
        addpoint( vb + (2+sqrt(1/2))*veci + (1+sq2)*vecj + sqrt(1/2)*veck )
        #break
    #case (10)
        addpoint( vb+(0.2+0.6*tau)*veci + (0.8+0.4*tau)*vecj + sqrt((3-tau)/5)*veck )
        addpoint( vb+(1.2+0.6*tau)*veci + (0.8+0.4*tau)*vecj + sqrt((3-tau)/5)*veck )
        addpoint( vb+(1.2+1.6*tau)*veci + (0.8+1.4*tau)*vecj + sqrt((3-tau)/5)*veck )
        addpoint( vb+(1.2+1.6*tau)*veci + (1.8+1.4*tau)*vecj + sqrt((3-tau)/5)*veck )
        addpoint( vb+(1.2+0.6*tau)*veci + (0.8+1.4*tau)*vecj + sqrt((3-tau)/5)*veck )
        #break
    #end
#end
#macro rotateabout(raxis,rangle,va)    // raxis must be a unit vector
    (vdot(raxis,va)*raxis
        + cos(rangle)*(va-vdot(raxis,va)*raxis)
        + sin(rangle)*(vcross(raxis,va)))
#end
#macro rotate_vtxs(raxis,rangle,thresh) // all points in the halfspace v.raxis &lt;= tresh
    #local i=0;
    #while (i&lt;npoints-.5)
        #if (vdot(points[i],raxis) &lt; thresh+0.01)
            #declare points[i]=rotateabout(raxis,pi*rangle/180,points[i]);
        #end   // if
    #local i=i+1;
    #end   //while
#end
#macro drop_vtx(n)
    #declare npoints=npoints-1;
    #if(n&lt;npoints)
        #declare points[n]=points[npoints];
    #end
#end
#macro drop_halfspace(normalvector,thresh) // all points in the halfspace v.raxis &lt; tresh
    #local i=0;
    #while (i&lt;npoints-.5)
        #if (vdot(points[i],normalvector)&lt;thresh-0.01)
            #debug concat("Drop vtx ",str(i,0,0)," of ",str(npoints,0,0)," &lt;",str(points[i].x,0,3),",",str(points[i].y,0,3),",",str(points[i].z,0,3),"&gt; (",str(vdot(points[i],normalvector),0,7),")\n")
            drop_vtx(i)
        #else
            #debug concat("Keep vtx ",str(i,0,0)," of ",str(npoints,0,0)," &lt;",str(points[i].x,0,3),",",str(points[i].y,0,3),",",str(points[i].z,0,3),"&gt; (",str(vdot(points[i],normalvector),0,7),")\n")
            #local i=i+1;
        #end
    #end
#end
#macro autobalance()   // moves the centre of gravity (cog) of the vertices to the origin
    #local cog=&lt;0,0,0&gt;;
    #local i=0;
    #while (i&lt;npoints-.5)
        #local cog=cog+points[i];
        #local i=i+1;
    #end
    #local cog=cog/npoints;
    #local i=0;
    #while (i&lt;npoints-.5)
        #declare points[i]=points[i] - cog;
        #local i=i+1;
    #end
#end


#macro showvtxs()
    #local i=0;
    #while (i&lt;npoints-.5)
        #debug concat("Vtx ",str(i,0,0)," of ",str(npoints,0,0),"= &lt;",str(points[i].x,0,7),",",str(points[i].y,0,7),",",str(points[i].z,0,7),"&gt;\n")
        #local i=i+1;
    #end
#end

#macro drawit()
    #local i=0;
    #while (i&lt;npoints)
        sphere { points[i], .05 dorot()
            pigment { colour &lt;.3,.3,.3&gt; }
            finish { ambient 0 diffuse 1 phong 1 } }
        #local j=0;
        #while (j&lt;npoints)
            #ifdef(edgelen[i][j])
                #local dist=vlength(points[i]-points[j]);
                cylinder { points[i],points[j], .02    dorot()
                    pigment {
                        #switch (dist-edgelen[i][j])
                        #range (-999,-0.1) colour &lt;1,0,0&gt;  #break
                        #range (0.1,999)   colour &lt;0,0,1&gt;  #break
                        #else
                        colour &lt;.3,.3,.3&gt;
                        #end
                    #debug concat("Edge ",str(i,0,0)," &amp; ",str(j,0,0)," has length ",str(dist,5,5)," want length ",str(edgelen[i][j],5,5),"\n")
                        }
                    finish { ambient 0 diffuse 1 phong 1 } }
            #end
            #local j=j+1;
        #end
        #local i=i+1;
    #end
#end

//--------------- macros to find "sporadic" Johnson solids via iterative optimisation kludge
#declare el=1;
#declare edgelen=array[120][120];
#declare forces=array[120];
#macro addedge(a,b,len)
    #declare edgelen[a][b]=len;
    #declare edgelen[b][a]=len;
#end
#macro make_triangle(a,b,c)
    addedge(a,b,el)    addedge(a,c,el) addedge(b,c,el)
#end
#macro make_square(a,b,c,d)
    addedge(a,b,el) addedge(b,c,el) addedge(c,d,el) addedge(d,a,el) addedge(a,c,sq2*el) addedge(b,d,sq2*el)
#end
#macro make_lune(a,b,c,d,e,f)  // a and d are points of lune
    make_triangle(a,b,f) make_square(b,c,e,f) make_triangle(c,d,e)
#end
#macro optimise(gen_threshold,force_threshold)
    #local gen=0;  #local maxforce=force_threshold+1; 
    #while ((gen&lt;gen_threshold) &amp; (maxforce&gt;force_threshold))
        #debug concat("Gen ",str(gen,0,0)," ")
//     showvtxs()
        #local maxforce=-999;
        #local i=0;
        #while (i&lt;npoints)
            #declare forces[i]=&lt;0,0,0&gt;;
            #local j=0;
            #while (j&lt;npoints)
                #ifdef(edgelen[i][j])
                    #local dist=vlength(points[i]-points[j]);
                    #declare forces[i] = forces[i]+ (dist-edgelen[i][j])*(points[j]-points[i]);
//                 #debug concat("Edge ",str(i,0,0)," &amp; ",str(j,0,0)," has length ",str(dist,5,5)," want length ",str(edgelen[i][j],5,5),"\n")
                #end
                #local j=j+1;
            #end
            #if (maxforce&lt;vlength(forces[i])) #local maxforce=vlength(forces[i]); #end
            #local i=i+1;
        #end
        #debug concat("maxforce=",str(maxforce,9,9),"\n")
        #local i=0;
        #while (i&lt;npoints)
            #declare points[i]=points[i]+.1*forces[i];
            #local i=i+1;
        #end
        #local gen=gen+1;
    #end
#end


// Johnson solids
// J1 = square_pyramid (octahedron with vtx dropped)
#macro square_pyramid()
  addevenpermssgn(&lt;1,0,0&gt;,&lt;1,0,0&gt;) drop_vtx(99)
  autobalance()  autoface()
#end
// J2 = pentagonal_pyramid (six vtxs of an icosahedron)
#macro pentagonal_pyramid()
    addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;) drop_halfspace(points[0],0)
    autobalance()  autoface()
#end
// ----------------- cuboctahedron modifications J - 3, 18, 22, 27, 35, 36, 44
// J3 = triangular_cupola (9 vtxs of a cuboctahedron)
#macro triangular_cupola()
    polygon_vtx(6)
    augment(6,points[0],points[1],points[2])
    autobalance()  autoface()
#end
#macro triangular_gyrobicupola()   //actually a cuboctahedron
    polygon_vtx(6)
    augment(6,points[0],points[1],points[2])
    augment(6,points[2],points[1],points[0])
    autobalance()  autoface()
#end
#macro elongated_triangular_cupola()   //J18
    rprism_vtx(6)
    augment(6,points[1],points[3],points[5])
    autobalance()  autoface()
#end
#macro gyroelongated_triangular_cupola()   //J22
    antiprism_vtx(6)
    augment(6,points[1],points[3],points[5])
    autobalance()  autoface()
#end
#macro triangular_orthobicupola()  //J27
    polygon_vtx(6)
    augment(6,points[0],points[1],points[2])
    augment(6,points[3],points[2],points[1])
    autobalance()  autoface()
#end
#macro elongated_triangular_orthobicupola()    //J35
    rprism_vtx(6)
    augment(6,points[1],points[3],points[5])
    augment(6,points[6],points[4],points[2])
    autobalance()  autoface()
#end
#macro elongated_triangular_gyrobicupola() //J36
    rprism_vtx(6)
    augment(6,points[1],points[3],points[5])
    augment(6,points[4],points[2],points[0])
    autobalance()  autoface()
#end
#macro gyroelongated_triangular_bicupola() //J44
    antiprism_vtx(6)
    augment(6,points[1],points[3],points[5])
    augment(6,points[4],points[2],points[0])
    autobalance()  autoface()
#end

// two triangular prisms
#macro gyrobifastigium() // J26
    addpointssgn(&lt;1,1,0&gt;,&lt;1,1,0&gt;)
    addpointssgn(&lt;1,0,sqrt(3)&gt;,&lt;1,0,0&gt;)
    addpointssgn(&lt;0,1,-sqrt(3)&gt;,&lt;0,1,0&gt;)
    autobalance()  autoface()
#end   
//---------------- miscellaneous cut and pasting
#macro elongated_pyramid(n)    // J7-9 (for n=3,4,5)
    rprism_vtx(n)
    augment(n,points[4],points[2],points[0])
    autobalance()  autoface()
#end

#macro dipyramid(n)    // J12 (n=3) and J13 (n=5)
    polygon_vtx(n)
    augment(n,points[0],points[1],points[2])
    augment(n,points[2],points[1],points[0])
    autobalance()  autoface()
#end
#macro elongated_dipyramid(n)  // J14-16 (for n=3,4,5)
    rprism_vtx(n)
    augment(n,points[4],points[2],points[0])
    augment(n,points[1],points[3],points[5])
    autobalance()  autoface()
#end
#macro elongated_triangular_dipyramid() elongated_dipyramid(3) #end    // J7
#macro elongated_square_dipyramid() elongated_dipyramid(3) #end    // J8
#macro elongated_pentagonal_dipyramid() elongated_dipyramid(3) #end    // J9

// ----------------- rhombicuboctahedron modifications J - 4, 19, 23, 28, 29, 37, 45
#macro rhombicuboctahedron_mod(j_number)
    addevenpermssgn(&lt;1+sq2,1,1&gt;,&lt;1,1,1&gt;)
    #local raxis=x;
    #local edgelen=2;
    #local oct_radius=sqrt(2*sq2+4);
    // drop hemisphere for 6, 21, 25 (have single rotunda)
    #if(j_number=4)    drop_halfspace(raxis,1) #end
    #if(j_number&lt;=23)  drop_halfspace(raxis,-1)    #end
    // stretch and twist
    #local stretch=0;  #local twist=0;
    #switch(j_number)
        #case(29)
            #local twist=45;
        #case(28)
            #local stretch=-edgelen;
            #break
        #case(37)
            #local twist=45;
            #break
        #case(23) #case(45)
            #local twist=22.5;
            #local stretch=oct_radius*2*sqrt((cos(pi/8)-cos(2*pi/8))/2)-edgelen; // borrowed from antiprism_vtx
    #end   //switch
    #if (stretch!=0)       // lower northern hemisphere
        #local i=0;
        #while (i&lt;npoints-.5)
            #if ((stretch = -2) &amp; ( vdot(points[i],raxis)=1))
                drop_vtx(i)
            #else
                #if (vdot(points[i],raxis)&gt;0)
                    #declare points[i]=points[i] + stretch*raxis;
                #end   // if
                #local i=i+1;
            #end //if
        #end   //while
    #end   //if
    #if (twist!=0)     // rotate southern hemisphere (incl equator)
        rotate_vtxs(raxis,twist,-1)
    #end
    autobalance()
#end
// Now the named macros of these modified rhombicuboctahedron
#macro square_cupola()                 rhombicuboctahedron_mod(4)  autoface() #end //  J4
#macro elongated_square_cupola()       rhombicuboctahedron_mod(19) autoface() #end //  J19
#macro gyroelongated_square_cupola()   rhombicuboctahedron_mod(23) autoface() #end //  J23
#macro square_orthobicupola()          rhombicuboctahedron_mod(28) autoface() #end //  J28
#macro square_gyrobicupola()           rhombicuboctahedron_mod(29) autoface() #end //  J29
#macro elongated_square_gyrobicupola() rhombicuboctahedron_mod(37) autoface() #end //  J37
#macro gyroelongated_square_bicupola() rhombicuboctahedron_mod(45) autoface() #end //  J45

#macro elongated_square_cupola_alt()   //  J19
    rprism_vtx(8)
    augment(8,points[4],points[2],points[0])
    autoface() #end

// J10.    (cap a square antiprism)
#macro gyroelongated_square_pyramid()
  antiprism_vtx(4)
  #local  va=points[1];
  addpoint(&lt;0,0,-(abs(va.z)+1)&gt;)
  autoface()
#end
// J17.    (bicap a square antiprism)
#macro gyroelongated_square_dipyramid()
  antiprism_vtx(4)
  #local  va=points[1];
  addpoint(&lt;0,0,abs(va.z)+1&gt;)
  addpoint(&lt;0,0,-(abs(va.z)+1)&gt;)
  autoface()
#end

// ----------------- icosahedron modifications
// J11.    (drop a vertex from an icosahedron)
#macro gyroelongated_pentagonal_pyramid()
  addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;)
  drop_vtx(99)
  autoface()
#end
// J62.    (drop 2 vertices from an icosahedron)
#macro metabidiminished_icosahedron()
  addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;)
  drop_vtx(99)
  drop_vtx(6)
  autoface()
#end
// J63.    (drop 3 vertices from an icosahedron)
#macro tridiminished_icosahedron()
  addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;)
  drop_vtx(99)
  drop_vtx(6)
  drop_vtx(0)  // 5 OK too
  autoface()
#end
// J64.    (drop 3 vertices from an icosahedron, add a tetrahedron)
#macro augmented_tridiminished_icosahedron()
  addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;)
  drop_vtx(99)
  drop_vtx(6)
  drop_vtx(0)
  augment(3,points[1],points[7],points[8])
  autoface()
#end

// -------------------- dodecahedron modifications: J58-61
#macro augmented_dodecahedron() //J58
  addpointssgn(&lt;1,1,1&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;0,1/tau,tau&gt;,&lt;0,1,1&gt;)
  augment(5,points[4],points[13],points[12])
  showvtxs()
  autobalance() autoface()
#end
#macro parabiaugmented_dodecahedron() //J59
  addpointssgn(&lt;1,1,1&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;0,1/tau,tau&gt;,&lt;0,1,1&gt;)
  augment(5,points[4],points[13],points[12])
  #local a=points[npoints-1];
  addpoint(-a)
  showvtxs()
  autobalance() autoface()
#end
#macro metabiaugmented_dodecahedron() //J60
  addpointssgn(&lt;1,1,1&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;0,1/tau,tau&gt;,&lt;0,1,1&gt;)
  augment(5,points[4],points[13],points[12])
  #local a=points[npoints-1];
  addpoint(&lt;a.y,a.z,a.x&gt;)
  showvtxs()
  autobalance() autoface()
#end
#macro triaugmented_dodecahedron() //J61
  addpointssgn(&lt;1,1,1&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;0,1/tau,tau&gt;,&lt;0,1,1&gt;)
  augment(5,points[4],points[13],points[12])
  #local a=points[npoints-1]; drop_vtx(999)
  addevenperms(a)
  showvtxs()
  autobalance() autoface()
#end

// ----------------- icosidodecahedron modifications
// Modified icosidodecahedron, for J- 6, 21, 25, 34, 42, 43, 48; J32,33,40,41,47
#macro icosidodecahedron_mod(j_number)
    addevenpermssgn(&lt;0,0,2*tau&gt;,&lt;0,0,1&gt;)
    addevenpermssgn(&lt;1,tau,1+tau&gt;,&lt;1,1,1&gt;)
    #local raxis=vnormalize(&lt;tau,1,0&gt;);
    #local edgelen=vlength(&lt;0,0,2*tau&gt;-&lt;1,tau,1+tau&gt;);
    #local id_radius=2*tau;
    // drop hemisphere for 6, 21, 25 (have single rotunda)
    #if((j_number&lt;=33) | (j_number=40) | (j_number=41) | (j_number=47))
        drop_halfspace(raxis,0)
        #if (j_number&gt;=32) // form a cupolarotunda
            augment(10,points[0],points[7],points[15])
        #end
    #end
    // stretch and twist
    #local stretch=0;  #local twist=0;
    #switch(j_number)
        #case(42) #case(40)
            #local stretch=edgelen;
        #case(34) #case(33)
            #local twist=36;
            #break
        #case(21) #case(43) #case(41)
            #local stretch=edgelen;
            #break
        #case(25) #case(48) #case(47)
            #local twist=18;
            #local stretch=id_radius*2*sqrt((cos(pi/10)-cos(2*pi/10))/2); // borrowed from antiprism_vtx
    #end   //switch
    #if (stretch&gt;0)        // raise northern hemisphere, duplicate equator
        #local i=0;    #local np=npoints;
        #while (i&lt;np-.5)
            #switch (vdot(points[i],raxis))
            #range(-0.01,0.01)
//             #debug concat("Dupl. vtx ",str(i,0,0)," of ",str(npoints,0,0)," &lt;",str(points[i].x,0,3),",",str(points[i].y,0,3),",",str(points[i].z,0,3),"&gt;\n")
                addpoint(points[i] + stretch*raxis)
            #break
            #range(0.01,999)
//             #debug concat("Raise vtx ",str(i,0,0)," of ",str(npoints,0,0)," &lt;",str(points[i].x,0,3),",",str(points[i].y,0,3),",",str(points[i].z,0,3),"&gt;\n")
                #declare points[i]=points[i] + stretch*raxis;
            #break
            #end   // switch
        #local i=i+1;
        #end   //while
    #end   //if
    #if (twist!=0)     // rotate southern hemisphere (incl equator)
        rotate_vtxs(raxis,twist,0)
    #end
    showvtxs()
    autobalance() autoface()
#end

#macro pentagonal_rotunda() icosidodecahedron_mod(6)    #end // J6. Half an icosidodecahedron
#macro elongated_pentagonal_rotunda() icosidodecahedron_mod(21)    #end // J21. Half an icosidodecahedron on a prism
#macro gyroelongated_pentagonal_rotunda() icosidodecahedron_mod(25)    #end // J25. Half an icosidodecahedron on an antiprism
#macro pentagonal_orthobirotunda() icosidodecahedron_mod(34)  #end // J34. Twisted icosidodecahedron
#macro elongated_pentagonal_gyrobirotunda() icosidodecahedron_mod(43)  #end // J43. Elongated icosidodecahedron
#macro elongated_pentagonal_orthobirotunda() icosidodecahedron_mod(42)  #end // J42. Elongated twisted icosidodecahedron
#macro gyroelongated_pentagonal_birotunda() icosidodecahedron_mod(48)  #end // J48. Elongated semitwisted icosidodecahedron

#macro pentagonal_orthocupolarotunda()  icosidodecahedron_mod(32)  #end    //J32
#macro pentagonal_gyrocupolarotunda()  icosidodecahedron_mod(33)  #end //J32

//---------------------- pentagonal cupolae, bicupolae
#macro elongated_pentagonal_cupola()   //J20
    rprism_vtx(10)
    augment(10,points[4],points[2],points[0])
    autobalance()  autoface()
#end
#macro gyroelongated_pentagonal_cupola()   //J24
    antiprism_vtx(10)
    augment(10,points[4],points[2],points[0])
    autobalance()  autoface()
#end

#macro pentagonal_orthobicupola()  //J30
    polygon_vtx(10)
    augment(10,points[0],points[1],points[2])
    augment(10,points[3],points[2],points[1])
    autobalance()  autoface()
#end

#macro pentagonal_gyrobicupola()   //J31
    polygon_vtx(10)
    augment(10,points[0],points[1],points[2])
    augment(10,points[2],points[1],points[0])
    autobalance()  autoface()
#end

#macro elongated_pentagonal_orthobicupola()    //J38
    rprism_vtx(10)
    augment(10,points[4],points[2],points[0])
    augment(10,points[3],points[5],points[7])
    autobalance()  autoface()
#end

#macro elongated_pentagonal_gyrobicupola() //J39
    rprism_vtx(10)
    augment(10,points[4],points[2],points[0])
    augment(10,points[1],points[3],points[5])
    showvtxs()
    autobalance()  autoface()
#end
#macro gyroelongated_pentagonal_bicupola() //J46
    antiprism_vtx(10)
    augment(10,points[4],points[2],points[0])
    augment(10,points[1],points[3],points[5])
    autobalance()  autoface()
#end

// -------------------- side-capped prisms : J49-57
#macro augmented_prisms(n,facelist)    // n=prism base, facelist=string with faces to cap
    rprism_vtx(n)
    #local i=1;
    #while(i&lt;=strlen(facelist))
        #local facenum=mod(val(substr(facelist,i,1)),n);   // convert ith char given to a number 0..(n-1)
        augment(4,points[2*facenum+1],points[2*facenum],points[mod(2*facenum+2,2*n)])
//     #debug concat("Augment face ",str(facenum,0,0)," of ",str(n,0,0), " &lt;",str(points[npoints-1].x,0,3),",",str(points[npoints-1].y,0,3),",",str(points[npoints-1].z,0,3),"&gt; \n")
        #local i=i+1;
    #end
    autobalance()  autoface()
#end
#macro augmented_triangular_prism() augmented_prisms(3,"0") #end   // J49
#macro biaugmented_triangular_prism() augmented_prisms(3,"01") #end    // J50
#macro triaugmented_triangular_prism() augmented_prisms(3,"012") #end  // J51
#macro augmented_pentagonal_prism()    augmented_prisms(5,"0") #end    // J52
#macro biaugmented_pentagonal_prism() augmented_prisms(5,"02") #end    // J53
#macro augmented_hexagonal_prism() augmented_prisms(6,"0") #end    // J54
#macro parabiaugmented_hexagonal_prism()   augmented_prisms(6,"03")    #end    // J55
#macro metabiaugmented_hexagonal_prism()   augmented_prisms(6,"02")    #end    // J56
#macro triaugmented_hexagonal_prism()  augmented_prisms(6,"024")   #end    // J57

// ----------------- rhombicosidodecahedron modifications 
#macro pentagonal_cupola() //J5
  addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
  addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
  #local raxis=vnormalize(&lt;tau,-1,0&gt;);
  drop_halfspace(raxis,3.077)
  autobalance()  autoface()
#end
#macro mogrified_rhombicosidodecahedron(mods)  //J72-J83
    // mods is a 4-character string of D (drop), G (gyrate) and other (leave alone)
    addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
    addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
    addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
    #local raxis=array[5];
    #local raxis[1]=vnormalize(&lt;tau,-1,0&gt;);
    #local raxis[2]=vnormalize(&lt;-1,0,tau&gt;);
    #local raxis[3]=vnormalize(&lt;-1,0,-tau&gt;);
    #local raxis[4]=-raxis[1];
    #local i=1;
    #while(i&lt;=min(4,strlen(mods)))
        #local modchar=substr(mods,i,1);
        #if (strcmp(modchar,"D")=0) drop_halfspace(-raxis[i],-3.077) #end
        #if (strcmp(modchar,"G")=0) rotate_vtxs(-raxis[i],36,-3.077) #end
        #local i=i+1;
    #end
    autobalance()  autoface()
#end

// #macro diminished_rhombicosidodecahedron()  //J76
//   addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
//   #local raxis=vnormalize(&lt;tau,-1,0&gt;);
//   drop_halfspace(-raxis,-3.077)
//   autobalance()  autoface()
// #end
// #macro tridiminished_rhombicosidodecahedron()   //J83
//   addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
//   #local raxis=vnormalize(&lt;tau,-1,0&gt;);
//   drop_halfspace(-raxis,-3.077)
//   #local raxis=vnormalize(&lt;-1,0,-tau&gt;);
//   drop_halfspace(-raxis,-3.077)
//   #local raxis=vnormalize(&lt;-1,0,tau&gt;);
//   drop_halfspace(-raxis,-3.077)
//   autobalance()  autoface()
// #end
// #macro metabidiminished_rhombicosidodecahedron()    //J81
//   addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
//   #local raxis=vnormalize(&lt;tau,-1,0&gt;);
//   drop_halfspace(-raxis,-3.077)
//   #local raxis=vnormalize(&lt;-1,0,tau&gt;);
//   drop_halfspace(-raxis,-3.077)
//   autobalance()  autoface()
// #end
// #macro parabidiminished_rhombicosidodecahedron()    //J80
//   addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
//   #local raxis=vnormalize(&lt;tau,-1,0&gt;);
//   drop_halfspace(-raxis,-3.077)
//   drop_halfspace( raxis,-3.077)
//   autobalance()  autoface()
// #end
// 
// #macro gyrate_rhombicosidodecahedron()  //J72
//   addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
//   #local raxis=vnormalize(&lt;tau,-1,0&gt;);
//   rotate_vtxs(-raxis,36,-3.077)
//   autobalance()  autoface()
// #end
// #macro trigyrate_rhombicosidodecahedron()   //J75
//   addevenpermssgn(&lt;1,1,1+2*tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;tau,2*tau,1+tau&gt;,&lt;1,1,1&gt;)
//   addevenpermssgn(&lt;2+tau,0,1+tau&gt;,&lt;1,0,1&gt;)
//   #local raxis=vnormalize(&lt;tau,-1,0&gt;);
//   rotate_vtxs(-raxis,36,-3.077)
//   #local raxis=vnormalize(&lt;-1,0,-tau&gt;);
//   rotate_vtxs(-raxis,36,-3.077)
//   #local raxis=vnormalize(&lt;-1,0,tau&gt;);
//   rotate_vtxs(-raxis,36,-3.077)
//   autobalance()  autoface()
// #end

////////////// sporadics

#macro snub_disphenoid()   // J84
    addpoint(&lt;1,0,0&gt;)  #local EQTR1=npoints-1;
    addpoint(&lt;0,1,0&gt;)  #local EQTR2=npoints-1;
    addpoint(&lt;-1,0,0&gt;) #local EQTR3=npoints-1;
    addpoint(&lt;0,-1,0&gt;) #local EQTR4=npoints-1;
    addpoint(&lt;1,0,1&gt;)  #local NORTH1=npoints-1;
    addpoint(&lt;-1,0,1&gt;) #local NORTH2=npoints-1;
    addpoint(&lt;0,1,-1&gt;) #local SOUTH1=npoints-1;
    addpoint(&lt;0,-1,-1&gt;)    #local SOUTH2=npoints-1;
    make_triangle(EQTR1,EQTR2,NORTH1)  make_triangle(EQTR1,EQTR2,SOUTH1)
    make_triangle(EQTR1,EQTR4,NORTH1)  make_triangle(EQTR1,EQTR4,SOUTH2)
    make_triangle(EQTR2,EQTR3,NORTH2)  make_triangle(EQTR2,EQTR3,SOUTH1)
    make_triangle(EQTR3,EQTR4,NORTH2)  make_triangle(EQTR3,EQTR4,SOUTH2)
    addedge(NORTH1,NORTH2,1)
    addedge(SOUTH1,SOUTH2,1)
    optimise(100,0.000001)
    autobalance()  autoface()
#end
    
#macro snub_square_antiprism() // J85
    addpoint(&lt;sq2,0,0&gt;)    #local E1=npoints-1;
    addpoint(&lt;1,1,0&gt;)  #local E2=npoints-1;
    addpoint(&lt;0,sq2,0&gt;)    #local E3=npoints-1;
    addpoint(&lt;-1,1,0&gt;) #local E4=npoints-1;
    addpoint(&lt;-sq2,0,0&gt;)   #local E5=npoints-1;
    addpoint(&lt;-1,-1,0&gt;)    #local E6=npoints-1;
    addpoint(&lt;0,-sq2,0&gt;)   #local E7=npoints-1;
    addpoint(&lt;1,-1,0&gt;) #local E8=npoints-1;
    addpoint(&lt;.5,.5,1&gt;)    #local N1=npoints-1;
    addpoint(&lt;-.5,.5,1&gt;)   #local N2=npoints-1;
    addpoint(&lt;-.5,-.5,1&gt;)  #local N3=npoints-1;
    addpoint(&lt;.5,-.5,1&gt;)   #local N4=npoints-1;
    addpoint(&lt;1/sq2,0,-1&gt;) #local S1=npoints-1;
    addpoint(&lt;0,1/sq2,-1&gt;) #local S2=npoints-1;
    addpoint(&lt;-1/sq2,0,-1&gt;)    #local S3=npoints-1;
    addpoint(&lt;0,-1/sq2,-1&gt;)    #local S4=npoints-1;
    make_triangle(E1,E2,N1)    make_triangle(E1,E2,S1)
    make_triangle(E2,E3,N1)    make_triangle(E2,E3,S2)
    make_triangle(E3,E4,N2)    make_triangle(E3,E4,S2)
    make_triangle(E4,E5,N2)    make_triangle(E4,E5,S3)
    make_triangle(E5,E6,N3)    make_triangle(E5,E6,S3)
    make_triangle(E6,E7,N3)    make_triangle(E6,E7,S4)
    make_triangle(E7,E8,N4)    make_triangle(E7,E8,S4)
    make_triangle(E8,E1,N4)    make_triangle(E8,E1,S1)
    addedge(N1,N2,1)       addedge(N2,N3,1)    addedge(N1,N3,sq2)
    addedge(N3,N4,1)       addedge(N4,N1,1)    addedge(N2,N4,sq2)
    addedge(S1,S2,1)       addedge(S2,S3,1)    addedge(S1,S3,sq2)
    addedge(S3,S4,1)       addedge(S4,S1,1)    addedge(S2,S4,sq2)
    optimise(400,0.00000001)
    autobalance()
    autoface()
#end

#macro sphenocoronae(n)    // J86 &amp; J87
    addpoint(&lt;1,0,0&gt;)  #local E1=npoints-1;
    addpoint(&lt;.5,1,0&gt;) #local E2=npoints-1;
    addpoint(&lt;-.5,1,0&gt;)    #local E3=npoints-1;
    addpoint(&lt;-1,0,0&gt;) #local E4=npoints-1;
    addpoint(&lt;-.5,-1,0&gt;)   #local E5=npoints-1;
    addpoint(&lt;.5,-1,0&gt;)    #local E6=npoints-1;
    addpoint(&lt;.5,0,1&gt;) #local N1=npoints-1;
    addpoint(&lt;-.5,0,1&gt;)    #local N2=npoints-1;
    addpoint(&lt;0,.5,-1&gt;)    #local S1=npoints-1;
    addpoint(&lt;0,-.5,-1&gt;)   #local S2=npoints-1;
    make_lune(E1,E2,E3,E4,N2,N1)
    make_lune(E4,E5,E6,E1,N1,N2)
    make_triangle(E1,E2,S1) make_triangle(E2,E3,S1) make_triangle(E3,E4,S1)
    make_triangle(E4,E5,S2) make_triangle(E5,E6,S2) make_triangle(E6,E1,S2)
    addedge(S1,S2,1)
    optimise(400,0.00000001)
    #if(n=87) augment(4,points[E2],points[E3],points[N2]) #end
    autobalance()
    autoface()
#end
#macro sphenocorona()  // J86
    sphenocoronae(86)
#end
#macro augmented_sphenocorona()    // J87
    sphenocoronae(87)
#end
#macro augmented_sphenocorona_old()    // J87
    addpoint(&lt;1,0,0&gt;)  #local E1=npoints-1;
    addpoint(&lt;.5,1,0&gt;) #local E2=npoints-1;
    addpoint(&lt;-.5,1,0&gt;)    #local E3=npoints-1;
    addpoint(&lt;-1,0,0&gt;) #local E4=npoints-1;
    addpoint(&lt;-.5,-1,0&gt;)   #local E5=npoints-1;
    addpoint(&lt;.5,-1,0&gt;)    #local E6=npoints-1;
    addpoint(&lt;.5,0,1&gt;) #local N1=npoints-1;
    addpoint(&lt;-.5,0,1&gt;)    #local N2=npoints-1;
    addpoint(&lt;0,.5,-1&gt;)    #local S1=npoints-1;
    addpoint(&lt;0,-.5,-1&gt;)   #local S2=npoints-1;
    make_lune(E1,E2,E3,E4,N2,N1)
    make_lune(E4,E5,E6,E1,N1,N2)
    make_triangle(E1,E2,S1) make_triangle(E2,E3,S1) make_triangle(E3,E4,S1)
    make_triangle(E4,E5,S2) make_triangle(E5,E6,S2) make_triangle(E6,E1,S2)
    addedge(S1,S2,1)
    addpoint(&lt;0,1,1&gt;)  #local A=npoints-1;
    make_triangle(A,E2,E3) make_triangle(A,N2,N1)
    optimise(400,0.00000001)
    autobalance()
    autoface()
#end
#macro sphenomegacorona()  // J88
    addpoint(&lt;1.3,0,0.1&gt;)  #local E1=npoints-1;
    addpoint(&lt;.5,.6,0&gt;)    #local E2=npoints-1;
    addpoint(&lt;-.5,.6,0&gt;)   #local E3=npoints-1;
    addpoint(&lt;-1.3,0,0.1&gt;) #local E4=npoints-1;
    addpoint(&lt;-.5,-.6,0&gt;)  #local E5=npoints-1;
    addpoint(&lt;.5,-.6,0&gt;)   #local E6=npoints-1;
    addpoint(&lt;.5,0,.7&gt;)    #local N1=npoints-1;
    addpoint(&lt;-.5,0,.7&gt;)   #local N2=npoints-1;
    addpoint(&lt;0,.5,-.9&gt;)   #local S1=npoints-1;
    addpoint(&lt;-.8,0,-.8&gt;)  #local S2=npoints-1;
    addpoint(&lt;0,-.5,-.9&gt;)  #local S3=npoints-1;
    addpoint(&lt;.8,0,-.8&gt;)   #local S4=npoints-1;
    make_lune(E1,E2,E3,E4,N2,N1)
    make_lune(E4,E5,E6,E1,N1,N2)
    make_triangle(E1,E2,S4) make_triangle(E2,E3,S1) make_triangle(E3,E4,S2)
    make_triangle(E4,E5,S2) make_triangle(E5,E6,S3) make_triangle(E6,E1,S4)
    make_triangle(S1,S2,S3)    make_triangle(S3,S4,S1)
    optimise(400,0.000001)
// showvtxs()
    autobalance()
    autoface()
#end
    
#macro hebesphenomegacorona()  // J89
    addpoint(&lt; 1.10, 0.00, 0.20&gt;)  #local E1=npoints-1;
    addpoint(&lt; 0.50, 0.72,-0.15&gt;)  #local E2=npoints-1;
    addpoint(&lt;-0.50, 0.72,-0.15&gt;)  #local E3=npoints-1;
    addpoint(&lt;-1.10, 0.00, 0.20&gt;)  #local E4=npoints-1;
    addpoint(&lt;-0.50,-0.72,-0.15&gt;)  #local E5=npoints-1;
    addpoint(&lt; 0.50,-0.72,-0.15&gt;)  #local E6=npoints-1;
    addpoint(&lt; 0.50, 0.50, 0.83&gt;)  #local N1=npoints-1;
    addpoint(&lt;-0.50, 0.50, 0.83&gt;)  #local N2=npoints-1;
    addpoint(&lt;-0.50,-0.50, 0.83&gt;)  #local N3=npoints-1;
    addpoint(&lt; 0.50,-0.50, 0.83&gt;)  #local N4=npoints-1;
    addpoint(&lt; 0.00, 0.50,-0.99&gt;)  #local S1=npoints-1;
    addpoint(&lt;-0.84, 0.00,-0.76&gt;)  #local S2=npoints-1;
    addpoint(&lt; 0.00,-0.50,-0.99&gt;)  #local S3=npoints-1;
    addpoint(&lt; 0.84, 0.00,-0.76&gt;)  #local S4=npoints-1;
    make_lune(E1,E2,E3,E4,N2,N1)
    make_lune(E4,E5,E6,E1,N4,N3)
    make_lune(E1,N1,N2,E4,N3,N4)

    make_triangle(E1,E2,S4) make_triangle(E2,E3,S1) make_triangle(E3,E4,S2)
    make_triangle(E4,E5,S2) make_triangle(E5,E6,S3) make_triangle(E6,E1,S4)
    make_triangle(S1,S2,S3)
    make_triangle(S3,S4,S1)
    optimise(400,0.000001)
    showvtxs()
    autobalance()
    autoface()
#end
    
#macro disphenocingulum()  //  J90
    addpoint(&lt; 0.00, 0.50, 1.10&gt;)  #local NN1=npoints-1;
    addpoint(&lt; 0.00,-0.50, 1.10&gt;)  #local NN2=npoints-1;
    addpoint(&lt; 0.00, 1.12, 0.33&gt;)  #local N1=npoints-1;
    addpoint(&lt; 0.77, 0.50, 0.46&gt;)  #local N2=npoints-1;
    addpoint(&lt; 0.77,-0.50, 0.46&gt;)  #local N3=npoints-1;
    addpoint(&lt; 0.00,-1.12, 0.33&gt;)  #local N4=npoints-1;
    addpoint(&lt;-0.77,-0.50, 0.46&gt;)  #local N5=npoints-1;
    addpoint(&lt;-0.77, 0.50, 0.46&gt;)  #local N6=npoints-1;
    addpoint(&lt; 0.50, 0.77,-0.46&gt;)  #local S1=npoints-1;
    addpoint(&lt; 1.12, 0.00,-0.33&gt;)  #local S2=npoints-1;
    addpoint(&lt; 0.50,-0.77,-0.46&gt;)  #local S3=npoints-1;
    addpoint(&lt;-0.50,-0.77,-0.46&gt;)  #local S4=npoints-1;
    addpoint(&lt;-1.12, 0.00,-0.33&gt;)  #local S5=npoints-1;
    addpoint(&lt;-0.50, 0.77,-0.46&gt;)  #local S6=npoints-1;
    addpoint(&lt; 0.50, 0.00,-1.10&gt;)  #local SS1=npoints-1;
    addpoint(&lt;-0.50, 0.00,-1.10&gt;)  #local SS2=npoints-1;
    make_lune(N1,N2,N3,N4,NN2,NN1)
    make_lune(N4,N5,N6,N1,NN1,NN2)
    make_lune(S2,SS1,SS2,S5,S6,S1)
    make_lune(S2,S3,S4,S5,SS2,SS1)
    make_triangle(N1,S1,N2)
    make_triangle(N2,S2,N3)
    make_triangle(N3,S3,N4)
    make_triangle(N4,S4,N5)
    make_triangle(N5,S5,N6)
    make_triangle(N6,S6,N1)
    optimise(400,0.000001)
    showvtxs()
    autobalance()
    autoface()
#end

#macro bilunabirotunda() // J91
    // start with icosahedron
  addevenpermssgn(&lt;0,1,tau&gt;,&lt;0,1,1&gt;)
  //   showvtxs()
  // trim back to 8 vertices
  drop_halfspace(&lt;-1,-tau,0&gt;,-tau)
  drop_halfspace(&lt;-1,tau,0&gt;,-tau)
  drop_halfspace(&lt;1,0,0&gt;,-1)
  // now shift all vertices into halfspace x &gt;= 0, and mirror
  #local i=0;#local minx=999;
  #while (i&lt;npoints)
    #local minx=min(minx,points[i].x);
    //#if (minx&gt;points[i].x) #local minx=points[i].x; #end
    #local i=i+1;
  #end // (while loop)
  #local i=0; #local np=npoints;
  #while (i&lt;np)
    #declare points[i]=points[i]+&lt;-minx,0,0&gt;;
    #if (points[i].x&gt;0) addpoint(&lt;-points[i].x,points[i].y,points[i].z&gt;) #end
    #local i=i+1;
  #end // (while loop)
  autoface()
#end

#macro triangular_hebesphenorotunda() // J91
    // Coords found by taking 7 vtxs of an icosahedron, placing one vtx
    // at origin, which is centre of the one hexagonal face.
    addevenperms( &lt;1,tau,0&gt;-&lt;tau,0,1&gt;)
    addevenperms( &lt;0,1,tau&gt;-&lt;tau,0,1&gt;)
    addevenperms( &lt;-1,tau,0&gt;-&lt;tau,0,1&gt;)
    addevenperms( &lt;-tau,0,1&gt;-&lt;tau,0,1&gt;)
    addevenperms( &lt;0,1,-tau&gt;-&lt;tau,0,1&gt;)
    addevenperms(-&lt;1,tau,0&gt;-&lt;tau,0,1&gt;)
    autobalance()
    autoface()
#end

//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; added AGK  [20041101]


#declare points=array[1000];
#declare tpoints=array[1000];
#declare npoints=0;
#declare faces=array[1000];
#declare nfaces=0;
#macro addpoint(a)
  #declare points[npoints]=a;
  #declare npoints=npoints+1;
#end
#macro addevenperms(a)
  addpoint(a)
  addpoint(&lt;a.y,a.z,a.x&gt;)
  addpoint(&lt;a.z,a.x,a.y&gt;)
#end
#macro addperms(a)
  addevenperms(a)
  addevenperms(&lt;a.x,a.z,a.y&gt;)
#end
#macro addpointssgn(a,s)
  addpoint(a)
  #if(s.x) addpointssgn(a*&lt;-1,1,1&gt;,s*&lt;0,1,1&gt;) #end
  #if(s.y) addpointssgn(a*&lt;1,-1,1&gt;,s*&lt;0,0,1&gt;) #end
  #if(s.z) addpoint(a*&lt;1,1,-1&gt;) #end
#end
#macro addevenpermssgn(a,s)
  addpointssgn(a,s)
  addpointssgn(&lt;a.y,a.z,a.x&gt;,<s>)
  addpointssgn(&lt;a.z,a.x,a.y&gt;,</s>)
#end
#macro addpermssgn(a,s)
  addevenpermssgn(a,s)
  addevenpermssgn(&lt;a.x,a.z,a.y&gt;,<s>)
#end
#macro addpointsevensgn(a)
  addpoint(a)
  addpoint(a*&lt;-1,-1,1&gt;)
  addpoint(a*&lt;-1,1,-1&gt;)
  addpoint(a*&lt;1,-1,-1&gt;)
#end
#macro addevenpermsevensgn(a)
  addevenperms(a)
  addevenperms(a*&lt;-1,-1,1&gt;)
  addevenperms(a*&lt;-1,1,-1&gt;)
  addevenperms(a*&lt;1,-1,-1&gt;)
#end
#macro addpermsaltsgn(a)
  addevenpermsevensgn(a)
  addevenpermsevensgn(&lt;a.x,a.z,-a.y&gt;)
#end
/*#macro addevenpermssgn(a,s) //Calls addevenperms with, for each 1 in s, a.{x,y,z} replaced with {+,-}a.{x,y,z}
  addevenperms(a)
  #if(s.x) addevenpermssgn(a*&lt;-1,1,1&gt;,s*&lt;0,1,1&gt;) #end
  #if(s.y) addevenpermssgn(a*&lt;1,-1,1&gt;,s*&lt;0,0,1&gt;) #end
  #if(s.z) addevenperms(a*&lt;1,1,-1&gt;) #end
#end*/
#macro addface(d,l)
  #local a=vnormalize(d)/l; 
  #local f=1;
  #local n=0; #while(n&lt;nfaces-.5)
    #if(vlength(faces[n]-a)&lt;0.00001) #local f=0; #end
  #local n=n+1; #end
  #if(f)
    #declare faces[nfaces]=a;
    #declare nfaces=nfaces+1;
  #end
#end
#macro dual()
  #declare temp=faces;
  #declare faces=points;
  #declare points=temp; 
  #declare temp=nfaces;
  #declare nfaces=npoints;
  #declare npoints=temp; 
#end


#macro autoface() //WARNING: ONLY WORKS IF ALL EDGES HAVE EQUAL LENGTH
  //Find edge length 
  #declare elength=1000;
  #local a=0; #while(a&lt;npoints-.5) #local b=0; #while(b&lt;npoints-.5)
    #local c=vlength(points[a]-points[b]); #if(c&gt;0.00001 &amp; c&lt;elength) #local elength=c; #end
  #local b=b+1; #end #local a=a+1; #end

        #debug concat("elength=",str(elength,9,9),"\n")    showvtxs()
 
  //Find planes
  //#macro planes()
  #local a=0; #while(a&lt;npoints-.5)
    #local b=a+1; #while(b&lt;npoints-.5)
      #if(vlength(points[a]-points[b])&lt;elength+0.00001) #local c=b+1; #while(c&lt;npoints-.5)
        #if(vlength(points[a]-points[c])&lt;elength+0.00001)
          #local n=vnormalize(vcross(points[b]-points[a],points[c]-points[a]));
          #local d=vdot(n,points[a]);
          #if(d&lt;0) #local n=-n; #local d=-d; #end
          #local f=1;
          #local e=0; #while(e&lt;npoints-.5)
            #if(vdot(n, points[e])&gt;d+0.00001) #local f=0; #end
          #local e=e+1; #end
          #if(f)
            #declare ld=d;
            addface(n,d) //plane { n, d }
          #end
        #end
      #local c=c+1; #end #end
    #local b=b+1; #end
  #local a=a+1; #end
#end

This_shape_will_be_drawn()

//Random rotations are (hopefully) equally distributed...
#declare rot1=rand(rotation)*pi*2;
#declare rot2=acos(1-2*rand(rotation));
#declare rot3=(rand(rotation)+clock)*pi*2;
#macro dorot()
  rotate rot1*180/pi*y
  rotate rot2*180/pi*x
  rotate rot3*180/pi*y
#end

// drawit()

#if(1)
    //Scale shape to fit in unit sphere
    #local b=0;
    #local a=0; #while(a&lt;npoints-.5)
      #local c=vlength(points[a]); #if(c&gt;b) #local b=c; #end
    #local a=a+1; #end
    #local a=0; #while(a&lt;npoints-.5)
      #local points[a]=points[a]/b;
    #local a=a+1; #end
    #local a=0; #while(a&lt;nfaces-.5)
      #local faces[a]=faces[a]*b;
    #local a=a+1; #end
#end

//Draw edges
#macro addp(a)
  #declare p[np]=a;
  #declare np=np+1;
#end
#local a=0; #while(a&lt;nfaces-.5)
  #declare p=array[20];
  #declare np=0;
  #local b=0; #while(b&lt;npoints-.5)
    #if(vdot(faces[a],points[b])&gt;1-0.00001) addp(b) #end
  #local b=b+1; #end
  #local c=0; #while(c&lt;np-.5)
    #local d=0; #while(d&lt;np-.5) #if(p[c]&lt;p[d]-.5)
      #local f=1;
      #local e=0; #while(e&lt;np-.5) #if(e!=c &amp; e!=d &amp; vdot(vcross(points[p[c]],points[p[d]]),points[p[e]])&lt;0)
        #local f=0;
      #end #local e=e+1; #end
      #if(f)
        object {
          cylinder { points[p[c]], points[p[d]], .01 dorot() }
          pigment { colour &lt;.3,.3,.3&gt; }
          finish { ambient 0 diffuse 1 phong 1 }
        }
      #end #end        
    #local d=d+1; #end
  #local c=c+1; #end
#local a=a+1; #end
/*#local a=0; #while(a&lt;npoints-.5)
  #local b=a+1; #while(b&lt;npoints-.5)
    #if(vlength(points[a]-points[b])&lt;elength+0.00001)
      object {
        cylinder { points[a], points[b], .01 dorot() }
        pigment { colour &lt;.3,.3,.3&gt; }
        finish { ambient 0 diffuse 1 phong 1 }
      }
    #end
  #local b=b+1; #end
#local a=a+1; #end*/

//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; changed AGK  [20041101]
//Draw points
#if (1)
    #local a=0; #while(a&lt;npoints-.5)
      object {
        sphere { points[a], .01 dorot() }
        pigment { colour &lt;.3,.3,.3&gt; }
        finish { ambient 0 diffuse 1 phong 1 }
      }
    #local a=a+1; #end
#else
    #local a=0; #while(a&lt;npoints-.5)
        #local i=0; 
        #while(i&lt;=a)
          object {
            sphere { (1+i/10)*points[a], .01 dorot() }
            pigment { colour &lt;.3,.3,.3&gt; }
            finish { ambient 0 diffuse 1 phong 1 }
          }
        #local i=i+1;
        #end
    #local a=a+1; #end
#end
//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; changed AGK  [20041101]

#if(notwireframe)
//Draw planes
object {
  intersection {
    #local a=0; #while(a&lt;nfaces-.5)
      plane { faces[a], 1/vlength(faces[a]) }
    #local a=a+1; #end
    //planes()
    //sphere { &lt;0,0,0&gt;, 1 }
    //sphere { &lt;0,0,0&gt;, ld+.01 inverse }
    dorot()
  }
  pigment { colour rgbt &lt;.8,.8,.8,.4&gt; }
  finish { ambient 0 diffuse 1 phong flashiness #if(withreflection) reflection { .2 } #end }
  //interior { ior 1.5 }
  photons {
    target on
    refraction on
    reflection on
    collect on
  }
}
#end

//  CCC Y Y PP
//  C   Y Y P P
//  C    Y  PP
//  C    Y  P
//  CCC  Y  P

#local a=0;
#while(a&lt;11.0001)
  light_source { &lt;4*sin(a*pi*2/11), 5*cos(a*pi*6/11), -4*cos(a*pi*2/11)&gt; colour (1+&lt;sin(a*pi*2/11),sin(a*pi*2/11+pi*2/3),sin(a*pi*2/11+pi*4/3)&gt;)*2/11 }
//  light_source { &lt;4*sin(a*pi*2/11), 5*cos(a*pi*6/11), -4*cos(a*pi*2/11)&gt; 
 //        colour (1+&lt;sin(a*pi*2/11),sin(a*pi*2/11+pi*2/3),sin(a*pi*2/11+pi*4/3)&gt;)*2/11 }
  #local a=a+1;
#end

background { color &lt;1,1,1&gt; }

#if (0)    // default framing vs auto-framing
    camera {
      perspective
      location &lt;0,0,0&gt;
      direction &lt;0,0,1&gt;
      right x/2
      up y/2
      sky &lt;0,1,0&gt;
      location &lt;0,0,-4.8&gt;
    //  location &lt;0,0,-10&gt;
      look_at &lt;0,0,0&gt;
    }
#else
    // some auto-framing.  Not for animated versions.
    #declare camera_loc=&lt;0,0,-4.8&gt;;
    #declare max_elevation=0;  #declare max_bearing=0;
    #declare i=0;
    #while (i&lt;npoints)
        #declare sighting=points[i];
        #declare sighting=vaxis_rotate(sighting,y,rot1*180/pi);
        #declare sighting=vaxis_rotate(sighting,x,rot2*180/pi);
        #declare sighting=vaxis_rotate(sighting,y,rot3*180/pi);
        #declare sighting=sighting-camera_loc;
        #declare elevation=sighting.y/sighting.z;
        #declare bearing=sighting.x/sighting.z;
        #declare max_elevation = max(max_elevation,abs(elevation));
        #declare max_bearing = max(max_bearing,abs(bearing));
    //     sphere{ (camera_loc+&lt;bearing,elevation,1&gt;*10), 0.2 
    //         pigment{ colour rgb &lt;1,0,1&gt; } }
        #declare i=i+1;
    #end
    #debug concat("Maximum: Elevation = ",str(max_elevation,4,4),"  Bearing = ",str(max_bearing,4,4),"\n")
    #if(1) // 1:1 aspect ratio
        #declare max_bearing = max(max_elevation,max_bearing); #declare max_elevation=max_bearing;
    #end
    #if(1) // 5% border
        #declare max_bearing=1.05*max_bearing;
        #declare max_elevation=1.05*max_elevation;
    #end
    camera {
      perspective
      location camera_loc
      direction &lt;0,0,.5&gt;
      right x*max_bearing
      up y*max_elevation
    }
#end
global_settings {
  max_trace_level 40
  photons {
    count 200000
    autostop 0
  }
}
</s>
</pre>
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org../../../a/n/d/User%7EAndrewKepert_poly.pov_78ed.html">http://en.wikipedia.org../../../a/n/d/User%7EAndrewKepert_poly.pov_78ed.html</a>"</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-user"
	       class="selected"	       ><a href="../../../a/n/d/User%7EAndrewKepert_poly.pov_78ed.html">User page</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../a/n/d/User_talk%7EAndrewKepert_poly.pov_10e5.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://en.wikipedia.org/wiki/User:AndrewKepert/poly.pov">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../images/wiki-en.png);"
	    href="../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-Main-page"><a href="../../../index.html">Main page</a></li>
	     	      <li id="n-Contents"><a href="../../../c/o/n/Wikipedia%7EContents_3181.html">Contents</a></li>
	     	      <li id="n-Featured-content"><a href="../../../f/e/a/Wikipedia%7EFeatured_content_24ba.html">Featured content</a></li>
	     	      <li id="n-currentevents"><a href="../../../c/u/r/Portal%7ECurrent_events_bb60.html">Current events</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-interaction'>
	  <h5>interaction</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-About-Wikipedia"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html">About Wikipedia</a></li>
	     	      <li id="n-portal"><a href="../../../c/o/m/Wikipedia%7ECommunity_Portal_6a3c.html">Community portal</a></li>
	     	      <li id="n-contact"><a href="../../../c/o/n/Wikipedia%7EContact_us_afd6.html">Contact us</a></li>
	     	      <li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Fundraising">Make a donation</a></li>
	     	      <li id="n-help"><a href="../../../c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="../../../images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 08:27, 2 December 2004 by Wikipedia user <a href="../../../a/n/d/User%7EAndrewKepert_6eb5.html" title="User:AndrewKepert">AndrewKepert</a>. </li>	  <li id="f-copyright">All text is available under the terms of the <a class='internal' href="../../../t/e/x/Wikipedia%7EText_of_the_GNU_Free_Documentation_License_702a.html" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="../../../c/o/p/Wikipedia%7ECopyrights_92c4.html" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc</a>., a US-registered <a class='internal' href="../../../5/0/1/501%28c%29.html#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="../../../n/o/n/Non-profit_organization.html" title="Non-profit organization">nonprofit</a> <a href="../../../c/h/a/Charitable_organization.html" title="Charitable organization">charity</a>.<br /></li>	  <li id="f-about"><a href="../../../a/b/o/Wikipedia%7EAbout_8d82.html" title="Wikipedia:About">About Wikipedia</a></li>	  <li id="f-disclaimer"><a href="../../../g/e/n/Wikipedia%7EGeneral_disclaimer_3e44.html" title="Wikipedia:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
